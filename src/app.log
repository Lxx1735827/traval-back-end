2024-11-30 16:08:43,590 - DEBUG - Using selector: SelectSelector
2024-11-30 16:08:43,649 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:08:43,814 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001F7466E5410>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:08:43,815 - INFO - Tortoise-ORM generating schema
2024-11-30 16:08:43,817 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:08:43,827 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:08:43,828 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001F764BC3450> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:08:43,828 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:08:47,699 - DEBUG - SELECT `username`,`password`,`id`,`number`,`avatar` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:08:47,701 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`location` `location`,`site`.`time_reference` `time_reference`,`site`.`picture` `picture`,`site`.`type` `type`,`site`.`id` `id`,`site`.`open_time` `open_time`,`site`.`description` `description`,`site`.`city` `city`,`site`.`ticket` `ticket`,`site`.`longitude` `longitude`,`site`.`telephone` `telephone`,`site`.`latitude` `latitude`,`site`.`transport` `transport`,`site`.`name` `name` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:08:47,702 - DEBUG - SELECT `username`,`password`,`id`,`number`,`avatar` FROM `user`: None
2024-11-30 16:08:47,703 - DEBUG - SELECT `site`.`location`,`site`.`time_reference`,`site`.`picture`,`site`.`type`,`site`.`id`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`ticket`,`site`.`longitude`,`site`.`telephone`,`site`.`latitude`,`site`.`transport`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:08:47,704 - DEBUG - SELECT `site`.`location`,`site`.`time_reference`,`site`.`picture`,`site`.`type`,`site`.`id`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`ticket`,`site`.`longitude`,`site`.`telephone`,`site`.`latitude`,`site`.`transport`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:08:47,706 - DEBUG - SELECT `site`.`location`,`site`.`time_reference`,`site`.`picture`,`site`.`type`,`site`.`id`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`ticket`,`site`.`longitude`,`site`.`telephone`,`site`.`latitude`,`site`.`transport`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:08:47,707 - DEBUG - SELECT `site`.`location`,`site`.`time_reference`,`site`.`picture`,`site`.`type`,`site`.`id`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`ticket`,`site`.`longitude`,`site`.`telephone`,`site`.`latitude`,`site`.`transport`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:08:47,708 - INFO - [(1, 2, 3, 4), (3, 4)]
2024-11-30 16:09:07,249 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:09:07,249 - INFO - Tortoise-ORM shutdown
2024-11-30 16:09:10,530 - DEBUG - Using selector: SelectSelector
2024-11-30 16:09:10,586 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:09:10,746 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001E1B8DEF650>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:09:10,746 - INFO - Tortoise-ORM generating schema
2024-11-30 16:09:10,749 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:09:10,757 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:09:10,758 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001E1B8DEFDD0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:09:10,758 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:09:26,225 - DEBUG - SELECT `number`,`id`,`avatar`,`password`,`username` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:09:26,227 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`city` `city`,`site`.`id` `id`,`site`.`time_reference` `time_reference`,`site`.`latitude` `latitude`,`site`.`open_time` `open_time`,`site`.`type` `type`,`site`.`location` `location`,`site`.`description` `description`,`site`.`name` `name`,`site`.`telephone` `telephone`,`site`.`ticket` `ticket`,`site`.`transport` `transport`,`site`.`longitude` `longitude`,`site`.`picture` `picture` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:09:26,229 - DEBUG - SELECT `number`,`id`,`avatar`,`password`,`username` FROM `user`: None
2024-11-30 16:09:26,229 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`time_reference`,`site`.`latitude`,`site`.`open_time`,`site`.`type`,`site`.`location`,`site`.`description`,`site`.`name`,`site`.`telephone`,`site`.`ticket`,`site`.`transport`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:09:26,231 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`time_reference`,`site`.`latitude`,`site`.`open_time`,`site`.`type`,`site`.`location`,`site`.`description`,`site`.`name`,`site`.`telephone`,`site`.`ticket`,`site`.`transport`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:09:26,231 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`time_reference`,`site`.`latitude`,`site`.`open_time`,`site`.`type`,`site`.`location`,`site`.`description`,`site`.`name`,`site`.`telephone`,`site`.`ticket`,`site`.`transport`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:09:26,232 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`time_reference`,`site`.`latitude`,`site`.`open_time`,`site`.`type`,`site`.`location`,`site`.`description`,`site`.`name`,`site`.`telephone`,`site`.`ticket`,`site`.`transport`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:09:26,233 - INFO - [(1, 2, 3, 4), (3, 4)]
2024-11-30 16:09:26,233 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2' LIMIT 2: None
2024-11-30 16:09:26,235 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2', '4']
2024-11-30 16:09:26,242 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1' LIMIT 2: None
2024-11-30 16:09:26,243 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1', '4']
2024-11-30 16:09:26,245 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2' LIMIT 2: None
2024-11-30 16:09:26,245 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2', '3', 1]
2024-11-30 16:09:26,247 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1' LIMIT 2: None
2024-11-30 16:09:26,248 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1', '3', 2]
2024-11-30 16:09:26,250 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='12' LIMIT 2: None
2024-11-30 16:09:26,250 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['12', '3']
2024-11-30 16:09:26,252 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2' LIMIT 2: None
2024-11-30 16:09:26,252 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2', '34', 1]
2024-11-30 16:09:26,255 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='23' LIMIT 2: None
2024-11-30 16:09:26,255 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['23', '4']
2024-11-30 16:09:26,257 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='24' LIMIT 2: None
2024-11-30 16:09:26,257 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['24', '3']
2024-11-30 16:09:26,259 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1' LIMIT 2: None
2024-11-30 16:09:26,259 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1', '34', 2]
2024-11-30 16:09:26,261 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='13' LIMIT 2: None
2024-11-30 16:09:26,261 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['13', '4']
2024-11-30 16:09:26,263 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='14' LIMIT 2: None
2024-11-30 16:09:26,263 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['14', '3']
2024-11-30 16:09:26,265 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='12' LIMIT 2: None
2024-11-30 16:09:26,265 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['12', '4', 3]
2024-11-30 16:09:26,267 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='12' LIMIT 2: None
2024-11-30 16:09:26,267 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['12', '34', 3]
2024-11-30 16:09:26,269 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='123' LIMIT 2: None
2024-11-30 16:09:26,269 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['123', '4']
2024-11-30 16:09:26,271 - DEBUG - SELECT `relate_id`,`site_from_ids`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='124' LIMIT 2: None
2024-11-30 16:09:26,271 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['124', '3']
2024-11-30 16:14:08,927 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:14:08,927 - INFO - Tortoise-ORM shutdown
2024-11-30 16:14:09,889 - DEBUG - Using selector: SelectSelector
2024-11-30 16:14:09,950 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:14:10,116 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000023EE491AB90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:14:10,117 - INFO - Tortoise-ORM generating schema
2024-11-30 16:14:10,119 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:14:10,127 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:14:10,127 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000023EFEDF3450> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:14:10,127 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:14:40,244 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:14:40,244 - INFO - Tortoise-ORM shutdown
2024-11-30 16:14:41,283 - DEBUG - Using selector: SelectSelector
2024-11-30 16:14:41,342 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:14:41,505 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000194F0582B10>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:14:41,505 - INFO - Tortoise-ORM generating schema
2024-11-30 16:14:41,505 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:14:41,521 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:14:41,521 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000194FED23F90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:14:41,521 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:23:56,072 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:23:56,072 - INFO - Tortoise-ORM shutdown
2024-11-30 16:24:01,276 - DEBUG - Using selector: SelectSelector
2024-11-30 16:24:01,342 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:24:01,552 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001676C118ED0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:24:01,552 - INFO - Tortoise-ORM generating schema
2024-11-30 16:24:01,554 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:24:01,564 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:24:01,565 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001676C45A590> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:24:01,566 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:24:05,325 - DEBUG - SELECT `username`,`number`,`password`,`avatar`,`id` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:24:05,326 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`description` `description`,`site`.`location` `location`,`site`.`open_time` `open_time`,`site`.`picture` `picture`,`site`.`telephone` `telephone`,`site`.`transport` `transport`,`site`.`name` `name`,`site`.`ticket` `ticket`,`site`.`time_reference` `time_reference`,`site`.`longitude` `longitude`,`site`.`type` `type`,`site`.`city` `city`,`site`.`id` `id`,`site`.`latitude` `latitude` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:24:05,329 - DEBUG - SELECT `site`.`description`,`site`.`location`,`site`.`open_time`,`site`.`picture`,`site`.`telephone`,`site`.`transport`,`site`.`name`,`site`.`ticket`,`site`.`time_reference`,`site`.`longitude`,`site`.`type`,`site`.`city`,`site`.`id`,`site`.`latitude` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:24:05,330 - DEBUG - SELECT `site`.`description`,`site`.`location`,`site`.`open_time`,`site`.`picture`,`site`.`telephone`,`site`.`transport`,`site`.`name`,`site`.`ticket`,`site`.`time_reference`,`site`.`longitude`,`site`.`type`,`site`.`city`,`site`.`id`,`site`.`latitude` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:25:23,890 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:25:23,890 - INFO - Tortoise-ORM shutdown
2024-11-30 16:27:51,474 - DEBUG - Using selector: SelectSelector
2024-11-30 16:27:51,534 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:27:51,726 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000002636D42F650>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:27:51,726 - INFO - Tortoise-ORM generating schema
2024-11-30 16:27:51,729 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:27:51,737 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:27:51,738 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000002637FD73710> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:27:51,738 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:27:55,788 - DEBUG - SELECT `id`,`password`,`number`,`username`,`avatar` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:27:55,790 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`id` `id`,`site`.`transport` `transport`,`site`.`time_reference` `time_reference`,`site`.`type` `type`,`site`.`latitude` `latitude`,`site`.`ticket` `ticket`,`site`.`name` `name`,`site`.`longitude` `longitude`,`site`.`picture` `picture`,`site`.`description` `description`,`site`.`open_time` `open_time`,`site`.`telephone` `telephone`,`site`.`location` `location`,`site`.`city` `city` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:27:55,792 - DEBUG - SELECT `site`.`id`,`site`.`transport`,`site`.`time_reference`,`site`.`type`,`site`.`latitude`,`site`.`ticket`,`site`.`name`,`site`.`longitude`,`site`.`picture`,`site`.`description`,`site`.`open_time`,`site`.`telephone`,`site`.`location`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:27:55,792 - DEBUG - SELECT `site`.`id`,`site`.`transport`,`site`.`time_reference`,`site`.`type`,`site`.`latitude`,`site`.`ticket`,`site`.`name`,`site`.`longitude`,`site`.`picture`,`site`.`description`,`site`.`open_time`,`site`.`telephone`,`site`.`location`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:27:55,793 - DEBUG - SELECT `relate_id`,`site_to_ids`,`site_from_ids` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4'): None
2024-11-30 16:28:13,919 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:28:13,919 - INFO - Tortoise-ORM shutdown
2024-11-30 16:30:39,201 - DEBUG - Using selector: SelectSelector
2024-11-30 16:30:39,263 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:30:39,454 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000029702EBD610>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:30:39,454 - INFO - Tortoise-ORM generating schema
2024-11-30 16:30:39,455 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:30:39,466 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:30:39,467 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000297030D0810> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:30:39,467 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:30:41,404 - DEBUG - SELECT `id`,`password`,`avatar`,`username`,`number` FROM `user`: None
2024-11-30 16:30:41,406 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`ticket`,`site`.`open_time`,`site`.`name`,`site`.`telephone`,`site`.`location`,`site`.`description`,`site`.`transport`,`site`.`type`,`site`.`time_reference`,`site`.`latitude`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:30:41,408 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`ticket`,`site`.`open_time`,`site`.`name`,`site`.`telephone`,`site`.`location`,`site`.`description`,`site`.`transport`,`site`.`type`,`site`.`time_reference`,`site`.`latitude`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:30:41,408 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`ticket`,`site`.`open_time`,`site`.`name`,`site`.`telephone`,`site`.`location`,`site`.`description`,`site`.`transport`,`site`.`type`,`site`.`time_reference`,`site`.`latitude`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:30:41,409 - DEBUG - SELECT `site`.`city`,`site`.`id`,`site`.`ticket`,`site`.`open_time`,`site`.`name`,`site`.`telephone`,`site`.`location`,`site`.`description`,`site`.`transport`,`site`.`type`,`site`.`time_reference`,`site`.`latitude`,`site`.`longitude`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:30:41,410 - INFO - [(1, 2, 3, 4), (3, 4)]
2024-11-30 16:30:41,410 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:30:41,411 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*', '4*']
2024-11-30 16:30:41,413 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:30:41,413 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*', '4*']
2024-11-30 16:30:41,421 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:30:41,422 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*', 10]
2024-11-30 16:30:41,424 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:30:41,424 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*', 11]
2024-11-30 16:30:41,427 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:30:41,427 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*', '3*']
2024-11-30 16:30:41,429 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:30:41,429 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*4*', 10]
2024-11-30 16:30:41,430 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:30:41,431 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*', '4*']
2024-11-30 16:30:41,432 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:30:41,433 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*4*', '3*']
2024-11-30 16:30:41,434 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:30:41,435 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*4*', 11]
2024-11-30 16:30:41,436 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:30:41,437 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*', '4*']
2024-11-30 16:30:41,437 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:30:41,438 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*4*', '3*']
2024-11-30 16:30:41,440 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:30:41,441 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '4*', 12]
2024-11-30 16:30:41,441 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:30:41,442 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '3*4*', 12]
2024-11-30 16:30:41,444 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:30:41,444 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*', '4*']
2024-11-30 16:30:41,446 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:30:41,446 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*', '3*']
2024-11-30 16:31:29,731 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:31:29,731 - INFO - Tortoise-ORM shutdown
2024-11-30 16:31:39,311 - DEBUG - Using selector: SelectSelector
2024-11-30 16:31:39,368 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:31:39,529 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000016B27955350>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:31:39,529 - INFO - Tortoise-ORM generating schema
2024-11-30 16:31:39,531 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:31:39,539 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:31:39,540 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000016B45E0FF50> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:31:39,540 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:31:43,307 - DEBUG - SELECT `username`,`password`,`number`,`avatar`,`id` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:31:43,308 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`name` `name`,`site`.`location` `location`,`site`.`open_time` `open_time`,`site`.`longitude` `longitude`,`site`.`time_reference` `time_reference`,`site`.`transport` `transport`,`site`.`picture` `picture`,`site`.`latitude` `latitude`,`site`.`id` `id`,`site`.`ticket` `ticket`,`site`.`type` `type`,`site`.`description` `description`,`site`.`city` `city`,`site`.`telephone` `telephone` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:31:43,309 - DEBUG - SELECT `site`.`name`,`site`.`location`,`site`.`open_time`,`site`.`longitude`,`site`.`time_reference`,`site`.`transport`,`site`.`picture`,`site`.`latitude`,`site`.`id`,`site`.`ticket`,`site`.`type`,`site`.`description`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:31:43,311 - DEBUG - SELECT `site`.`name`,`site`.`location`,`site`.`open_time`,`site`.`longitude`,`site`.`time_reference`,`site`.`transport`,`site`.`picture`,`site`.`latitude`,`site`.`id`,`site`.`ticket`,`site`.`type`,`site`.`description`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:31:43,312 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4'): None
2024-11-30 16:32:31,346 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:32:31,346 - INFO - Tortoise-ORM shutdown
2024-11-30 16:32:34,362 - DEBUG - Using selector: SelectSelector
2024-11-30 16:32:34,418 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:32:34,580 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000002EEEB7E87D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:32:34,580 - INFO - Tortoise-ORM generating schema
2024-11-30 16:32:34,582 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:32:34,593 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:32:34,594 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000002EEEBB00810> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:32:34,594 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:32:36,996 - DEBUG - SELECT `username`,`id`,`number`,`avatar`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:32:36,998 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`open_time` `open_time`,`site`.`id` `id`,`site`.`description` `description`,`site`.`ticket` `ticket`,`site`.`telephone` `telephone`,`site`.`latitude` `latitude`,`site`.`location` `location`,`site`.`name` `name`,`site`.`transport` `transport`,`site`.`picture` `picture`,`site`.`type` `type`,`site`.`longitude` `longitude`,`site`.`time_reference` `time_reference`,`site`.`city` `city` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:32:36,999 - DEBUG - SELECT `site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`ticket`,`site`.`telephone`,`site`.`latitude`,`site`.`location`,`site`.`name`,`site`.`transport`,`site`.`picture`,`site`.`type`,`site`.`longitude`,`site`.`time_reference`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:32:37,000 - DEBUG - SELECT `site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`ticket`,`site`.`telephone`,`site`.`latitude`,`site`.`location`,`site`.`name`,`site`.`transport`,`site`.`picture`,`site`.`type`,`site`.`longitude`,`site`.`time_reference`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:32:37,001 - DEBUG - SELECT `site_from_ids`,`site_to_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4'): None
2024-11-30 16:35:55,817 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:35:55,817 - INFO - Tortoise-ORM shutdown
2024-11-30 16:35:56,894 - DEBUG - Looking up time zone info from registry
2024-11-30 16:36:01,164 - DEBUG - Looking up time zone info from registry
2024-11-30 16:36:01,169 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:36:01,170 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:36:01,170 - INFO - Scheduler started
2024-11-30 16:36:01,171 - DEBUG - Looking for jobs to run
2024-11-30 16:36:01,171 - DEBUG - Next wakeup is due at 2024-11-30 16:36:11.169982+08:00 (in 9.998486 seconds)
2024-11-30 16:36:02,145 - DEBUG - Looking up time zone info from registry
2024-11-30 16:36:02,150 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:36:02,151 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:36:02,151 - INFO - Scheduler started
2024-11-30 16:36:02,151 - DEBUG - Looking for jobs to run
2024-11-30 16:36:02,152 - DEBUG - Next wakeup is due at 2024-11-30 16:36:12.150550+08:00 (in 9.997977 seconds)
2024-11-30 16:36:02,159 - DEBUG - Using selector: SelectSelector
2024-11-30 16:36:02,221 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:36:02,221 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:36:02,221 - INFO - Scheduler started
2024-11-30 16:36:02,222 - DEBUG - Looking for jobs to run
2024-11-30 16:36:02,222 - DEBUG - Next wakeup is due at 2024-11-30 16:36:12.221131+08:00 (in 9.998998 seconds)
2024-11-30 16:36:02,222 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:36:02,402 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000021D9BF4FF50>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:36:02,402 - INFO - Tortoise-ORM generating schema
2024-11-30 16:36:02,404 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:36:02,412 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:36:02,413 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000021D9B9E7810> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:36:02,414 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:36:11,176 - DEBUG - Looking for jobs to run
2024-11-30 16:36:11,177 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:11 CST)" (scheduled at 2024-11-30 16:36:11.169982+08:00)
2024-11-30 16:36:11,177 - DEBUG - Next wakeup is due at 2024-11-30 16:36:21.169982+08:00 (in 9.992576 seconds)
2024-11-30 16:36:11,177 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:21 CST)" executed successfully
2024-11-30 16:36:12,158 - DEBUG - Looking for jobs to run
2024-11-30 16:36:12,158 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:12 CST)" (scheduled at 2024-11-30 16:36:12.150550+08:00)
2024-11-30 16:36:12,160 - DEBUG - Next wakeup is due at 2024-11-30 16:36:22.150550+08:00 (in 9.990500 seconds)
2024-11-30 16:36:12,160 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:22 CST)" executed successfully
2024-11-30 16:36:12,222 - DEBUG - Looking for jobs to run
2024-11-30 16:36:12,222 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:12 CST)" (scheduled at 2024-11-30 16:36:12.221131+08:00)
2024-11-30 16:36:12,222 - DEBUG - Next wakeup is due at 2024-11-30 16:36:22.221131+08:00 (in 9.999074 seconds)
2024-11-30 16:36:12,222 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:22 CST)" executed successfully
2024-11-30 16:36:21,173 - DEBUG - Looking for jobs to run
2024-11-30 16:36:21,173 - DEBUG - Next wakeup is due at 2024-11-30 16:36:31.169982+08:00 (in 9.996579 seconds)
2024-11-30 16:36:21,173 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:31 CST)" (scheduled at 2024-11-30 16:36:21.169982+08:00)
2024-11-30 16:36:21,173 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:31 CST)" executed successfully
2024-11-30 16:36:22,156 - DEBUG - Looking for jobs to run
2024-11-30 16:36:22,156 - DEBUG - Next wakeup is due at 2024-11-30 16:36:32.150550+08:00 (in 9.993856 seconds)
2024-11-30 16:36:22,156 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:32 CST)" (scheduled at 2024-11-30 16:36:22.150550+08:00)
2024-11-30 16:36:22,156 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:32 CST)" executed successfully
2024-11-30 16:36:22,235 - DEBUG - Looking for jobs to run
2024-11-30 16:36:22,235 - DEBUG - Next wakeup is due at 2024-11-30 16:36:32.221131+08:00 (in 9.985180 seconds)
2024-11-30 16:36:22,235 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:32 CST)" (scheduled at 2024-11-30 16:36:22.221131+08:00)
2024-11-30 16:36:22,235 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:32 CST)" executed successfully
2024-11-30 16:36:31,183 - DEBUG - Looking for jobs to run
2024-11-30 16:36:31,183 - DEBUG - Next wakeup is due at 2024-11-30 16:36:41.169982+08:00 (in 9.986267 seconds)
2024-11-30 16:36:31,183 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:41 CST)" (scheduled at 2024-11-30 16:36:31.169982+08:00)
2024-11-30 16:36:31,183 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:41 CST)" executed successfully
2024-11-30 16:36:32,164 - DEBUG - Looking for jobs to run
2024-11-30 16:36:32,164 - DEBUG - Next wakeup is due at 2024-11-30 16:36:42.150550+08:00 (in 9.985995 seconds)
2024-11-30 16:36:32,164 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:42 CST)" (scheduled at 2024-11-30 16:36:32.150550+08:00)
2024-11-30 16:36:32,164 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:42 CST)" executed successfully
2024-11-30 16:36:32,228 - DEBUG - Looking for jobs to run
2024-11-30 16:36:32,228 - DEBUG - Next wakeup is due at 2024-11-30 16:36:42.221131+08:00 (in 9.992833 seconds)
2024-11-30 16:36:32,228 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:42 CST)" (scheduled at 2024-11-30 16:36:32.221131+08:00)
2024-11-30 16:36:32,228 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:42 CST)" executed successfully
2024-11-30 16:36:41,178 - DEBUG - Looking for jobs to run
2024-11-30 16:36:41,178 - DEBUG - Next wakeup is due at 2024-11-30 16:36:51.169982+08:00 (in 9.991899 seconds)
2024-11-30 16:36:41,178 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:51 CST)" (scheduled at 2024-11-30 16:36:41.169982+08:00)
2024-11-30 16:36:41,180 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:51 CST)" executed successfully
2024-11-30 16:36:42,156 - DEBUG - Looking for jobs to run
2024-11-30 16:36:42,156 - DEBUG - Next wakeup is due at 2024-11-30 16:36:52.150550+08:00 (in 9.993789 seconds)
2024-11-30 16:36:42,156 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:52 CST)" (scheduled at 2024-11-30 16:36:42.150550+08:00)
2024-11-30 16:36:42,156 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:52 CST)" executed successfully
2024-11-30 16:36:42,235 - DEBUG - Looking for jobs to run
2024-11-30 16:36:42,235 - DEBUG - Next wakeup is due at 2024-11-30 16:36:52.221131+08:00 (in 9.985391 seconds)
2024-11-30 16:36:42,235 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:52 CST)" (scheduled at 2024-11-30 16:36:42.221131+08:00)
2024-11-30 16:36:42,235 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:36:52 CST)" executed successfully
2024-11-30 16:36:51,178 - DEBUG - Looking for jobs to run
2024-11-30 16:36:51,178 - DEBUG - Next wakeup is due at 2024-11-30 16:37:01.169982+08:00 (in 9.991169 seconds)
2024-11-30 16:36:51,178 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:01 CST)" (scheduled at 2024-11-30 16:36:51.169982+08:00)
2024-11-30 16:36:51,178 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:01 CST)" executed successfully
2024-11-30 16:36:52,156 - DEBUG - Looking for jobs to run
2024-11-30 16:36:52,156 - DEBUG - Next wakeup is due at 2024-11-30 16:37:02.150550+08:00 (in 9.993912 seconds)
2024-11-30 16:36:52,156 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:02 CST)" (scheduled at 2024-11-30 16:36:52.150550+08:00)
2024-11-30 16:36:52,156 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:02 CST)" executed successfully
2024-11-30 16:36:52,234 - DEBUG - Looking for jobs to run
2024-11-30 16:36:52,234 - DEBUG - Next wakeup is due at 2024-11-30 16:37:02.221131+08:00 (in 9.986570 seconds)
2024-11-30 16:36:52,234 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:02 CST)" (scheduled at 2024-11-30 16:36:52.221131+08:00)
2024-11-30 16:36:52,234 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:02 CST)" executed successfully
2024-11-30 16:37:01,172 - DEBUG - Looking for jobs to run
2024-11-30 16:37:01,172 - DEBUG - Next wakeup is due at 2024-11-30 16:37:11.169982+08:00 (in 9.997148 seconds)
2024-11-30 16:37:01,172 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:11 CST)" (scheduled at 2024-11-30 16:37:01.169982+08:00)
2024-11-30 16:37:01,172 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:11 CST)" executed successfully
2024-11-30 16:37:02,166 - DEBUG - Looking for jobs to run
2024-11-30 16:37:02,166 - DEBUG - Next wakeup is due at 2024-11-30 16:37:12.150550+08:00 (in 9.984540 seconds)
2024-11-30 16:37:02,166 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:12 CST)" (scheduled at 2024-11-30 16:37:02.150550+08:00)
2024-11-30 16:37:02,166 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:12 CST)" executed successfully
2024-11-30 16:37:02,228 - DEBUG - Looking for jobs to run
2024-11-30 16:37:02,228 - DEBUG - Next wakeup is due at 2024-11-30 16:37:12.221131+08:00 (in 9.992170 seconds)
2024-11-30 16:37:02,228 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:12 CST)" (scheduled at 2024-11-30 16:37:02.221131+08:00)
2024-11-30 16:37:02,228 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:12 CST)" executed successfully
2024-11-30 16:37:11,178 - DEBUG - Looking for jobs to run
2024-11-30 16:37:11,178 - DEBUG - Next wakeup is due at 2024-11-30 16:37:21.169982+08:00 (in 9.991487 seconds)
2024-11-30 16:37:11,178 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:21 CST)" (scheduled at 2024-11-30 16:37:11.169982+08:00)
2024-11-30 16:37:11,178 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:21 CST)" executed successfully
2024-11-30 16:37:12,161 - DEBUG - Looking for jobs to run
2024-11-30 16:37:12,161 - DEBUG - Next wakeup is due at 2024-11-30 16:37:22.150550+08:00 (in 9.988596 seconds)
2024-11-30 16:37:12,161 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:22 CST)" (scheduled at 2024-11-30 16:37:12.150550+08:00)
2024-11-30 16:37:12,161 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:22 CST)" executed successfully
2024-11-30 16:37:12,224 - DEBUG - Looking for jobs to run
2024-11-30 16:37:12,224 - DEBUG - Next wakeup is due at 2024-11-30 16:37:22.221131+08:00 (in 9.996318 seconds)
2024-11-30 16:37:12,224 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:22 CST)" (scheduled at 2024-11-30 16:37:12.221131+08:00)
2024-11-30 16:37:12,225 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:22 CST)" executed successfully
2024-11-30 16:37:21,175 - DEBUG - Looking for jobs to run
2024-11-30 16:37:21,175 - DEBUG - Next wakeup is due at 2024-11-30 16:37:31.169982+08:00 (in 9.994023 seconds)
2024-11-30 16:37:21,175 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:31 CST)" (scheduled at 2024-11-30 16:37:21.169982+08:00)
2024-11-30 16:37:21,175 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:31 CST)" executed successfully
2024-11-30 16:37:22,164 - DEBUG - Looking for jobs to run
2024-11-30 16:37:22,164 - DEBUG - Next wakeup is due at 2024-11-30 16:37:32.150550+08:00 (in 9.986016 seconds)
2024-11-30 16:37:22,164 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:32 CST)" (scheduled at 2024-11-30 16:37:22.150550+08:00)
2024-11-30 16:37:22,164 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:32 CST)" executed successfully
2024-11-30 16:37:22,228 - DEBUG - Looking for jobs to run
2024-11-30 16:37:22,228 - DEBUG - Next wakeup is due at 2024-11-30 16:37:32.221131+08:00 (in 9.992722 seconds)
2024-11-30 16:37:22,228 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:32 CST)" (scheduled at 2024-11-30 16:37:22.221131+08:00)
2024-11-30 16:37:22,228 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:32 CST)" executed successfully
2024-11-30 16:37:31,181 - DEBUG - Looking for jobs to run
2024-11-30 16:37:31,181 - DEBUG - Next wakeup is due at 2024-11-30 16:37:41.169982+08:00 (in 9.988374 seconds)
2024-11-30 16:37:31,181 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:41 CST)" (scheduled at 2024-11-30 16:37:31.169982+08:00)
2024-11-30 16:37:31,181 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:41 CST)" executed successfully
2024-11-30 16:37:32,160 - DEBUG - Looking for jobs to run
2024-11-30 16:37:32,160 - DEBUG - Next wakeup is due at 2024-11-30 16:37:42.150550+08:00 (in 9.990323 seconds)
2024-11-30 16:37:32,160 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:42 CST)" (scheduled at 2024-11-30 16:37:32.150550+08:00)
2024-11-30 16:37:32,160 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:42 CST)" executed successfully
2024-11-30 16:37:32,223 - DEBUG - Looking for jobs to run
2024-11-30 16:37:32,223 - DEBUG - Next wakeup is due at 2024-11-30 16:37:42.221131+08:00 (in 9.997621 seconds)
2024-11-30 16:37:32,223 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:42 CST)" (scheduled at 2024-11-30 16:37:32.221131+08:00)
2024-11-30 16:37:32,223 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:42 CST)" executed successfully
2024-11-30 16:37:41,185 - DEBUG - Looking for jobs to run
2024-11-30 16:37:41,185 - DEBUG - Next wakeup is due at 2024-11-30 16:37:51.169982+08:00 (in 9.984422 seconds)
2024-11-30 16:37:41,185 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:51 CST)" (scheduled at 2024-11-30 16:37:41.169982+08:00)
2024-11-30 16:37:41,185 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:51 CST)" executed successfully
2024-11-30 16:37:42,165 - DEBUG - Looking for jobs to run
2024-11-30 16:37:42,165 - DEBUG - Next wakeup is due at 2024-11-30 16:37:52.150550+08:00 (in 9.984985 seconds)
2024-11-30 16:37:42,165 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:52 CST)" (scheduled at 2024-11-30 16:37:42.150550+08:00)
2024-11-30 16:37:42,165 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:52 CST)" executed successfully
2024-11-30 16:37:42,228 - DEBUG - Looking for jobs to run
2024-11-30 16:37:42,228 - DEBUG - Next wakeup is due at 2024-11-30 16:37:52.221131+08:00 (in 9.992712 seconds)
2024-11-30 16:37:42,228 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:52 CST)" (scheduled at 2024-11-30 16:37:42.221131+08:00)
2024-11-30 16:37:42,228 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:37:52 CST)" executed successfully
2024-11-30 16:37:51,183 - DEBUG - Looking for jobs to run
2024-11-30 16:37:51,183 - DEBUG - Next wakeup is due at 2024-11-30 16:38:01.169982+08:00 (in 9.986210 seconds)
2024-11-30 16:37:51,183 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:01 CST)" (scheduled at 2024-11-30 16:37:51.169982+08:00)
2024-11-30 16:37:51,183 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:01 CST)" executed successfully
2024-11-30 16:37:52,153 - DEBUG - Looking for jobs to run
2024-11-30 16:37:52,153 - DEBUG - Next wakeup is due at 2024-11-30 16:38:02.150550+08:00 (in 9.996869 seconds)
2024-11-30 16:37:52,153 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:02 CST)" (scheduled at 2024-11-30 16:37:52.150550+08:00)
2024-11-30 16:37:52,153 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:02 CST)" executed successfully
2024-11-30 16:37:52,229 - DEBUG - Looking for jobs to run
2024-11-30 16:37:52,229 - DEBUG - Next wakeup is due at 2024-11-30 16:38:02.221131+08:00 (in 9.991253 seconds)
2024-11-30 16:37:52,229 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:02 CST)" (scheduled at 2024-11-30 16:37:52.221131+08:00)
2024-11-30 16:37:52,229 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:02 CST)" executed successfully
2024-11-30 16:38:01,171 - DEBUG - Looking for jobs to run
2024-11-30 16:38:01,171 - DEBUG - Next wakeup is due at 2024-11-30 16:38:11.169982+08:00 (in 9.998127 seconds)
2024-11-30 16:38:01,171 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:11 CST)" (scheduled at 2024-11-30 16:38:01.169982+08:00)
2024-11-30 16:38:01,171 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:11 CST)" executed successfully
2024-11-30 16:38:02,152 - DEBUG - Looking for jobs to run
2024-11-30 16:38:02,152 - DEBUG - Next wakeup is due at 2024-11-30 16:38:12.150550+08:00 (in 9.997986 seconds)
2024-11-30 16:38:02,152 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:12 CST)" (scheduled at 2024-11-30 16:38:02.150550+08:00)
2024-11-30 16:38:02,152 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:12 CST)" executed successfully
2024-11-30 16:38:02,231 - DEBUG - Looking for jobs to run
2024-11-30 16:38:02,231 - DEBUG - Next wakeup is due at 2024-11-30 16:38:12.221131+08:00 (in 9.989336 seconds)
2024-11-30 16:38:02,231 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:12 CST)" (scheduled at 2024-11-30 16:38:02.221131+08:00)
2024-11-30 16:38:02,231 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:12 CST)" executed successfully
2024-11-30 16:38:11,184 - DEBUG - Looking for jobs to run
2024-11-30 16:38:11,184 - DEBUG - Next wakeup is due at 2024-11-30 16:38:21.169982+08:00 (in 9.985172 seconds)
2024-11-30 16:38:11,184 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:21 CST)" (scheduled at 2024-11-30 16:38:11.169982+08:00)
2024-11-30 16:38:11,184 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:21 CST)" executed successfully
2024-11-30 16:38:12,165 - DEBUG - Looking for jobs to run
2024-11-30 16:38:12,165 - DEBUG - Next wakeup is due at 2024-11-30 16:38:22.150550+08:00 (in 9.984589 seconds)
2024-11-30 16:38:12,165 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:22 CST)" (scheduled at 2024-11-30 16:38:12.150550+08:00)
2024-11-30 16:38:12,165 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:22 CST)" executed successfully
2024-11-30 16:38:12,228 - DEBUG - Looking for jobs to run
2024-11-30 16:38:12,228 - DEBUG - Next wakeup is due at 2024-11-30 16:38:22.221131+08:00 (in 9.992278 seconds)
2024-11-30 16:38:12,228 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:22 CST)" (scheduled at 2024-11-30 16:38:12.221131+08:00)
2024-11-30 16:38:12,228 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:22 CST)" executed successfully
2024-11-30 16:38:21,183 - DEBUG - Looking for jobs to run
2024-11-30 16:38:21,183 - DEBUG - Next wakeup is due at 2024-11-30 16:38:31.169982+08:00 (in 9.986574 seconds)
2024-11-30 16:38:21,183 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:31 CST)" (scheduled at 2024-11-30 16:38:21.169982+08:00)
2024-11-30 16:38:21,183 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:31 CST)" executed successfully
2024-11-30 16:38:21,238 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string7' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:21,238 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string7', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:38:22,152 - DEBUG - Looking for jobs to run
2024-11-30 16:38:22,152 - DEBUG - Next wakeup is due at 2024-11-30 16:38:32.150550+08:00 (in 9.998242 seconds)
2024-11-30 16:38:22,152 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:32 CST)" (scheduled at 2024-11-30 16:38:22.150550+08:00)
2024-11-30 16:38:22,152 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:32 CST)" executed successfully
2024-11-30 16:38:22,227 - DEBUG - Looking for jobs to run
2024-11-30 16:38:22,227 - DEBUG - Next wakeup is due at 2024-11-30 16:38:32.221131+08:00 (in 9.993857 seconds)
2024-11-30 16:38:22,227 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:32 CST)" (scheduled at 2024-11-30 16:38:22.221131+08:00)
2024-11-30 16:38:22,227 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:32 CST)" executed successfully
2024-11-30 16:38:29,237 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string8' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:29,238 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string8', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:38:31,170 - DEBUG - Looking for jobs to run
2024-11-30 16:38:31,170 - DEBUG - Next wakeup is due at 2024-11-30 16:38:41.169982+08:00 (in 9.999412 seconds)
2024-11-30 16:38:31,170 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:41 CST)" (scheduled at 2024-11-30 16:38:31.169982+08:00)
2024-11-30 16:38:31,170 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:41 CST)" executed successfully
2024-11-30 16:38:32,157 - DEBUG - Looking for jobs to run
2024-11-30 16:38:32,157 - DEBUG - Next wakeup is due at 2024-11-30 16:38:42.150550+08:00 (in 9.992994 seconds)
2024-11-30 16:38:32,157 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:42 CST)" (scheduled at 2024-11-30 16:38:32.150550+08:00)
2024-11-30 16:38:32,157 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:42 CST)" executed successfully
2024-11-30 16:38:32,236 - DEBUG - Looking for jobs to run
2024-11-30 16:38:32,236 - DEBUG - Next wakeup is due at 2024-11-30 16:38:42.221131+08:00 (in 9.984577 seconds)
2024-11-30 16:38:32,236 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:42 CST)" (scheduled at 2024-11-30 16:38:32.221131+08:00)
2024-11-30 16:38:32,236 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:42 CST)" executed successfully
2024-11-30 16:38:33,206 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string9' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:33,207 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string9', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:38:36,628 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string10' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:36,629 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string10', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:38:41,182 - DEBUG - Looking for jobs to run
2024-11-30 16:38:41,182 - DEBUG - Next wakeup is due at 2024-11-30 16:38:51.169982+08:00 (in 9.987480 seconds)
2024-11-30 16:38:41,182 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:51 CST)" (scheduled at 2024-11-30 16:38:41.169982+08:00)
2024-11-30 16:38:41,182 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:51 CST)" executed successfully
2024-11-30 16:38:42,162 - DEBUG - Looking for jobs to run
2024-11-30 16:38:42,162 - DEBUG - Next wakeup is due at 2024-11-30 16:38:52.150550+08:00 (in 9.988188 seconds)
2024-11-30 16:38:42,162 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:52 CST)" (scheduled at 2024-11-30 16:38:42.150550+08:00)
2024-11-30 16:38:42,162 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:52 CST)" executed successfully
2024-11-30 16:38:42,225 - DEBUG - Looking for jobs to run
2024-11-30 16:38:42,225 - DEBUG - Next wakeup is due at 2024-11-30 16:38:52.221131+08:00 (in 9.995457 seconds)
2024-11-30 16:38:42,225 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:52 CST)" (scheduled at 2024-11-30 16:38:42.221131+08:00)
2024-11-30 16:38:42,225 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:38:52 CST)" executed successfully
2024-11-30 16:38:51,175 - DEBUG - Looking for jobs to run
2024-11-30 16:38:51,175 - DEBUG - Next wakeup is due at 2024-11-30 16:39:01.169982+08:00 (in 9.994432 seconds)
2024-11-30 16:38:51,175 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:01 CST)" (scheduled at 2024-11-30 16:38:51.169982+08:00)
2024-11-30 16:38:51,175 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:01 CST)" executed successfully
2024-11-30 16:38:52,155 - DEBUG - Looking for jobs to run
2024-11-30 16:38:52,155 - DEBUG - Next wakeup is due at 2024-11-30 16:39:02.150550+08:00 (in 9.995003 seconds)
2024-11-30 16:38:52,155 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:02 CST)" (scheduled at 2024-11-30 16:38:52.150550+08:00)
2024-11-30 16:38:52,155 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:02 CST)" executed successfully
2024-11-30 16:38:52,233 - DEBUG - Looking for jobs to run
2024-11-30 16:38:52,233 - DEBUG - Next wakeup is due at 2024-11-30 16:39:02.221131+08:00 (in 9.987247 seconds)
2024-11-30 16:38:52,233 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:02 CST)" (scheduled at 2024-11-30 16:38:52.221131+08:00)
2024-11-30 16:38:52,233 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:02 CST)" executed successfully
2024-11-30 16:38:55,109 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string10' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:59,613 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string11' AND `city`='string' LIMIT 2: None
2024-11-30 16:38:59,615 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string11', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:39:01,177 - DEBUG - Looking for jobs to run
2024-11-30 16:39:01,177 - DEBUG - Next wakeup is due at 2024-11-30 16:39:11.169982+08:00 (in 9.992356 seconds)
2024-11-30 16:39:01,177 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:11 CST)" (scheduled at 2024-11-30 16:39:01.169982+08:00)
2024-11-30 16:39:01,177 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:11 CST)" executed successfully
2024-11-30 16:39:02,158 - DEBUG - Looking for jobs to run
2024-11-30 16:39:02,158 - DEBUG - Next wakeup is due at 2024-11-30 16:39:12.150550+08:00 (in 9.992530 seconds)
2024-11-30 16:39:02,158 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:12 CST)" (scheduled at 2024-11-30 16:39:02.150550+08:00)
2024-11-30 16:39:02,158 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:12 CST)" executed successfully
2024-11-30 16:39:02,224 - DEBUG - Looking for jobs to run
2024-11-30 16:39:02,225 - DEBUG - Next wakeup is due at 2024-11-30 16:39:12.221131+08:00 (in 9.996119 seconds)
2024-11-30 16:39:02,225 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:12 CST)" (scheduled at 2024-11-30 16:39:02.221131+08:00)
2024-11-30 16:39:02,225 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:12 CST)" executed successfully
2024-11-30 16:39:02,607 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `name`='string12' AND `city`='string' LIMIT 2: None
2024-11-30 16:39:02,608 - DEBUG - INSERT INTO `site` (`name`,`city`,`description`,`picture`,`location`,`telephone`,`time_reference`,`transport`,`ticket`,`open_time`,`longitude`,`latitude`,`type`) VALUES (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s): ['string12', 'string', 'string', 'static/site/默认图片.png', 'string', 'string', 'string', 'string', 'string', 'string', Decimal('0'), Decimal('0'), '景点']
2024-11-30 16:39:11,171 - DEBUG - Looking for jobs to run
2024-11-30 16:39:11,171 - DEBUG - Next wakeup is due at 2024-11-30 16:39:21.169982+08:00 (in 9.998211 seconds)
2024-11-30 16:39:11,171 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:21 CST)" (scheduled at 2024-11-30 16:39:11.169982+08:00)
2024-11-30 16:39:11,171 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:21 CST)" executed successfully
2024-11-30 16:39:12,156 - DEBUG - Looking for jobs to run
2024-11-30 16:39:12,156 - DEBUG - Next wakeup is due at 2024-11-30 16:39:22.150550+08:00 (in 9.994206 seconds)
2024-11-30 16:39:12,156 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:22 CST)" (scheduled at 2024-11-30 16:39:12.150550+08:00)
2024-11-30 16:39:12,156 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:22 CST)" executed successfully
2024-11-30 16:39:12,231 - DEBUG - Looking for jobs to run
2024-11-30 16:39:12,231 - DEBUG - Next wakeup is due at 2024-11-30 16:39:22.221131+08:00 (in 9.989292 seconds)
2024-11-30 16:39:12,231 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:22 CST)" (scheduled at 2024-11-30 16:39:12.221131+08:00)
2024-11-30 16:39:12,231 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:22 CST)" executed successfully
2024-11-30 16:39:15,246 - DEBUG - SELECT `username`,`password`,`id`,`number`,`avatar` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:39:15,247 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `id`=7 LIMIT 2: None
2024-11-30 16:39:15,249 - DEBUG - SELECT `site_id` FROM `user_site` WHERE `user_id`=1 AND `site_id`=7: None
2024-11-30 16:39:15,249 - DEBUG - INSERT INTO `user_site` (`site_id`,`user_id`) VALUES (7,1): None
2024-11-30 16:39:19,986 - DEBUG - SELECT `username`,`password`,`id`,`number`,`avatar` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:39:19,987 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `id`=8 LIMIT 2: None
2024-11-30 16:39:19,988 - DEBUG - SELECT `site_id` FROM `user_site` WHERE `user_id`=1 AND `site_id`=8: None
2024-11-30 16:39:19,988 - DEBUG - INSERT INTO `user_site` (`site_id`,`user_id`) VALUES (8,1): None
2024-11-30 16:39:21,174 - DEBUG - Looking for jobs to run
2024-11-30 16:39:21,174 - DEBUG - Next wakeup is due at 2024-11-30 16:39:31.169982+08:00 (in 9.995619 seconds)
2024-11-30 16:39:21,174 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:31 CST)" (scheduled at 2024-11-30 16:39:21.169982+08:00)
2024-11-30 16:39:21,174 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:31 CST)" executed successfully
2024-11-30 16:39:22,158 - DEBUG - Looking for jobs to run
2024-11-30 16:39:22,158 - DEBUG - Next wakeup is due at 2024-11-30 16:39:32.150550+08:00 (in 9.992215 seconds)
2024-11-30 16:39:22,158 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:32 CST)" (scheduled at 2024-11-30 16:39:22.150550+08:00)
2024-11-30 16:39:22,158 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:32 CST)" executed successfully
2024-11-30 16:39:22,222 - DEBUG - Looking for jobs to run
2024-11-30 16:39:22,222 - DEBUG - Next wakeup is due at 2024-11-30 16:39:32.221131+08:00 (in 9.999074 seconds)
2024-11-30 16:39:22,222 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:32 CST)" (scheduled at 2024-11-30 16:39:22.221131+08:00)
2024-11-30 16:39:22,223 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:32 CST)" executed successfully
2024-11-30 16:39:24,860 - DEBUG - SELECT `username`,`password`,`id`,`number`,`avatar` FROM `user` WHERE `number`='222' LIMIT 2: None
2024-11-30 16:39:24,861 - DEBUG - SELECT `time_reference`,`open_time`,`picture`,`description`,`transport`,`telephone`,`city`,`name`,`longitude`,`latitude`,`ticket`,`location`,`id`,`type` FROM `site` WHERE `id`=8 LIMIT 2: None
2024-11-30 16:39:24,862 - DEBUG - SELECT `site_id` FROM `user_site` WHERE `user_id`=2 AND `site_id`=8: None
2024-11-30 16:39:24,863 - DEBUG - INSERT INTO `user_site` (`site_id`,`user_id`) VALUES (8,2): None
2024-11-30 16:39:31,177 - DEBUG - Looking for jobs to run
2024-11-30 16:39:31,177 - DEBUG - Next wakeup is due at 2024-11-30 16:39:41.169982+08:00 (in 9.992895 seconds)
2024-11-30 16:39:31,177 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:41 CST)" (scheduled at 2024-11-30 16:39:31.169982+08:00)
2024-11-30 16:39:31,177 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:41 CST)" executed successfully
2024-11-30 16:39:32,157 - DEBUG - Looking for jobs to run
2024-11-30 16:39:32,157 - DEBUG - Next wakeup is due at 2024-11-30 16:39:42.150550+08:00 (in 9.992721 seconds)
2024-11-30 16:39:32,157 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:42 CST)" (scheduled at 2024-11-30 16:39:32.150550+08:00)
2024-11-30 16:39:32,157 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:42 CST)" executed successfully
2024-11-30 16:39:32,237 - DEBUG - Looking for jobs to run
2024-11-30 16:39:32,237 - DEBUG - Next wakeup is due at 2024-11-30 16:39:42.221131+08:00 (in 9.983613 seconds)
2024-11-30 16:39:32,237 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:42 CST)" (scheduled at 2024-11-30 16:39:32.221131+08:00)
2024-11-30 16:39:32,237 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:42 CST)" executed successfully
2024-11-30 16:39:41,176 - DEBUG - Looking for jobs to run
2024-11-30 16:39:41,176 - DEBUG - Next wakeup is due at 2024-11-30 16:39:51.169982+08:00 (in 9.993876 seconds)
2024-11-30 16:39:41,176 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:51 CST)" (scheduled at 2024-11-30 16:39:41.169982+08:00)
2024-11-30 16:39:41,176 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:51 CST)" executed successfully
2024-11-30 16:39:42,165 - DEBUG - Looking for jobs to run
2024-11-30 16:39:42,165 - DEBUG - Next wakeup is due at 2024-11-30 16:39:52.150550+08:00 (in 9.985279 seconds)
2024-11-30 16:39:42,165 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:52 CST)" (scheduled at 2024-11-30 16:39:42.150550+08:00)
2024-11-30 16:39:42,166 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:52 CST)" executed successfully
2024-11-30 16:39:42,227 - DEBUG - Looking for jobs to run
2024-11-30 16:39:42,227 - DEBUG - Next wakeup is due at 2024-11-30 16:39:52.221131+08:00 (in 9.993583 seconds)
2024-11-30 16:39:42,227 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:52 CST)" (scheduled at 2024-11-30 16:39:42.221131+08:00)
2024-11-30 16:39:42,227 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:39:52 CST)" executed successfully
2024-11-30 16:39:51,177 - DEBUG - Looking for jobs to run
2024-11-30 16:39:51,177 - DEBUG - Next wakeup is due at 2024-11-30 16:40:01.169982+08:00 (in 9.992775 seconds)
2024-11-30 16:39:51,177 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:01 CST)" (scheduled at 2024-11-30 16:39:51.169982+08:00)
2024-11-30 16:39:51,177 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:01 CST)" executed successfully
2024-11-30 16:39:52,162 - DEBUG - Looking for jobs to run
2024-11-30 16:39:52,162 - DEBUG - Next wakeup is due at 2024-11-30 16:40:02.150550+08:00 (in 9.988395 seconds)
2024-11-30 16:39:52,162 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:02 CST)" (scheduled at 2024-11-30 16:39:52.150550+08:00)
2024-11-30 16:39:52,163 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:02 CST)" executed successfully
2024-11-30 16:39:52,223 - DEBUG - Looking for jobs to run
2024-11-30 16:39:52,223 - DEBUG - Next wakeup is due at 2024-11-30 16:40:02.221131+08:00 (in 9.997304 seconds)
2024-11-30 16:39:52,223 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:02 CST)" (scheduled at 2024-11-30 16:39:52.221131+08:00)
2024-11-30 16:39:52,223 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:02 CST)" executed successfully
2024-11-30 16:40:01,170 - DEBUG - Looking for jobs to run
2024-11-30 16:40:01,170 - DEBUG - Next wakeup is due at 2024-11-30 16:40:11.169982+08:00 (in 9.999147 seconds)
2024-11-30 16:40:01,170 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:11 CST)" (scheduled at 2024-11-30 16:40:01.169982+08:00)
2024-11-30 16:40:01,170 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:11 CST)" executed successfully
2024-11-30 16:40:02,161 - DEBUG - Looking for jobs to run
2024-11-30 16:40:02,161 - DEBUG - Next wakeup is due at 2024-11-30 16:40:12.150550+08:00 (in 9.988746 seconds)
2024-11-30 16:40:02,161 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:12 CST)" (scheduled at 2024-11-30 16:40:02.150550+08:00)
2024-11-30 16:40:02,163 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:12 CST)" executed successfully
2024-11-30 16:40:02,224 - DEBUG - Looking for jobs to run
2024-11-30 16:40:02,224 - DEBUG - Next wakeup is due at 2024-11-30 16:40:12.221131+08:00 (in 9.996580 seconds)
2024-11-30 16:40:02,224 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:12 CST)" (scheduled at 2024-11-30 16:40:02.221131+08:00)
2024-11-30 16:40:02,224 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:12 CST)" executed successfully
2024-11-30 16:40:11,183 - DEBUG - Looking for jobs to run
2024-11-30 16:40:11,183 - DEBUG - Next wakeup is due at 2024-11-30 16:40:21.169982+08:00 (in 9.986133 seconds)
2024-11-30 16:40:11,183 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:21 CST)" (scheduled at 2024-11-30 16:40:11.169982+08:00)
2024-11-30 16:40:11,184 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:21 CST)" executed successfully
2024-11-30 16:40:12,154 - DEBUG - Looking for jobs to run
2024-11-30 16:40:12,154 - DEBUG - Next wakeup is due at 2024-11-30 16:40:22.150550+08:00 (in 9.996029 seconds)
2024-11-30 16:40:12,154 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:22 CST)" (scheduled at 2024-11-30 16:40:12.150550+08:00)
2024-11-30 16:40:12,154 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:22 CST)" executed successfully
2024-11-30 16:40:12,233 - DEBUG - Looking for jobs to run
2024-11-30 16:40:12,233 - DEBUG - Next wakeup is due at 2024-11-30 16:40:22.221131+08:00 (in 9.987929 seconds)
2024-11-30 16:40:12,233 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:22 CST)" (scheduled at 2024-11-30 16:40:12.221131+08:00)
2024-11-30 16:40:12,233 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:22 CST)" executed successfully
2024-11-30 16:40:18,709 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:40:18,710 - INFO - Tortoise-ORM shutdown
2024-11-30 16:40:38,334 - DEBUG - Looking up time zone info from registry
2024-11-30 16:40:38,338 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:40:38,338 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:40:38,338 - INFO - Scheduler started
2024-11-30 16:40:38,339 - DEBUG - Looking for jobs to run
2024-11-30 16:40:38,339 - DEBUG - Next wakeup is due at 2024-11-30 16:40:48.338882+08:00 (in 9.999000 seconds)
2024-11-30 16:40:39,399 - DEBUG - Looking up time zone info from registry
2024-11-30 16:40:39,404 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:40:39,404 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:40:39,404 - INFO - Scheduler started
2024-11-30 16:40:39,405 - DEBUG - Looking for jobs to run
2024-11-30 16:40:39,405 - DEBUG - Next wakeup is due at 2024-11-30 16:40:49.404216+08:00 (in 9.998997 seconds)
2024-11-30 16:40:39,413 - DEBUG - Using selector: SelectSelector
2024-11-30 16:40:39,470 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:40:39,470 - INFO - Added job "insert_data" to job store "default"
2024-11-30 16:40:39,470 - INFO - Scheduler started
2024-11-30 16:40:39,471 - DEBUG - Looking for jobs to run
2024-11-30 16:40:39,471 - DEBUG - Next wakeup is due at 2024-11-30 16:40:49.470342+08:00 (in 9.998999 seconds)
2024-11-30 16:40:39,472 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:40:39,629 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000178FA681410>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:40:39,630 - INFO - Tortoise-ORM generating schema
2024-11-30 16:40:39,632 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:40:39,638 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:40:39,638 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000178FA3AB510> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:40:39,639 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:40:48,343 - DEBUG - Looking for jobs to run
2024-11-30 16:40:48,344 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:48 CST)" (scheduled at 2024-11-30 16:40:48.338882+08:00)
2024-11-30 16:40:48,344 - DEBUG - Next wakeup is due at 2024-11-30 16:40:58.338882+08:00 (in 9.994798 seconds)
2024-11-30 16:40:48,344 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:58 CST)" executed successfully
2024-11-30 16:40:49,419 - DEBUG - Looking for jobs to run
2024-11-30 16:40:49,419 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:49 CST)" (scheduled at 2024-11-30 16:40:49.404216+08:00)
2024-11-30 16:40:49,419 - DEBUG - Next wakeup is due at 2024-11-30 16:40:59.404216+08:00 (in 9.984837 seconds)
2024-11-30 16:40:49,419 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:59 CST)" executed successfully
2024-11-30 16:40:49,481 - DEBUG - Looking for jobs to run
2024-11-30 16:40:49,482 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:49 CST)" (scheduled at 2024-11-30 16:40:49.470342+08:00)
2024-11-30 16:40:49,482 - DEBUG - Next wakeup is due at 2024-11-30 16:40:59.470342+08:00 (in 9.987992 seconds)
2024-11-30 16:40:49,482 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:40:59 CST)" executed successfully
2024-11-30 16:40:58,353 - DEBUG - Looking for jobs to run
2024-11-30 16:40:58,353 - DEBUG - Next wakeup is due at 2024-11-30 16:41:08.338882+08:00 (in 9.984984 seconds)
2024-11-30 16:40:58,353 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:08 CST)" (scheduled at 2024-11-30 16:40:58.338882+08:00)
2024-11-30 16:40:58,353 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:08 CST)" executed successfully
2024-11-30 16:40:59,409 - DEBUG - Looking for jobs to run
2024-11-30 16:40:59,409 - DEBUG - Next wakeup is due at 2024-11-30 16:41:09.404216+08:00 (in 9.994411 seconds)
2024-11-30 16:40:59,409 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:09 CST)" (scheduled at 2024-11-30 16:40:59.404216+08:00)
2024-11-30 16:40:59,409 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:09 CST)" executed successfully
2024-11-30 16:40:59,471 - DEBUG - Looking for jobs to run
2024-11-30 16:40:59,471 - DEBUG - Next wakeup is due at 2024-11-30 16:41:09.470342+08:00 (in 9.999084 seconds)
2024-11-30 16:40:59,471 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:09 CST)" (scheduled at 2024-11-30 16:40:59.470342+08:00)
2024-11-30 16:40:59,471 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:09 CST)" executed successfully
2024-11-30 16:41:08,341 - DEBUG - Looking for jobs to run
2024-11-30 16:41:08,341 - DEBUG - Next wakeup is due at 2024-11-30 16:41:18.338882+08:00 (in 9.997836 seconds)
2024-11-30 16:41:08,341 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:18 CST)" (scheduled at 2024-11-30 16:41:08.338882+08:00)
2024-11-30 16:41:08,341 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:18 CST)" executed successfully
2024-11-30 16:41:09,419 - DEBUG - Looking for jobs to run
2024-11-30 16:41:09,419 - DEBUG - Next wakeup is due at 2024-11-30 16:41:19.404216+08:00 (in 9.985070 seconds)
2024-11-30 16:41:09,419 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:19 CST)" (scheduled at 2024-11-30 16:41:09.404216+08:00)
2024-11-30 16:41:09,419 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:19 CST)" executed successfully
2024-11-30 16:41:09,481 - DEBUG - Looking for jobs to run
2024-11-30 16:41:09,481 - DEBUG - Next wakeup is due at 2024-11-30 16:41:19.470342+08:00 (in 9.989119 seconds)
2024-11-30 16:41:09,481 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:19 CST)" (scheduled at 2024-11-30 16:41:09.470342+08:00)
2024-11-30 16:41:09,481 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:19 CST)" executed successfully
2024-11-30 16:41:18,346 - DEBUG - Looking for jobs to run
2024-11-30 16:41:18,346 - DEBUG - Next wakeup is due at 2024-11-30 16:41:28.338882+08:00 (in 9.991958 seconds)
2024-11-30 16:41:18,346 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:28 CST)" (scheduled at 2024-11-30 16:41:18.338882+08:00)
2024-11-30 16:41:18,346 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:28 CST)" executed successfully
2024-11-30 16:41:19,415 - DEBUG - Looking for jobs to run
2024-11-30 16:41:19,415 - DEBUG - Next wakeup is due at 2024-11-30 16:41:29.404216+08:00 (in 9.988452 seconds)
2024-11-30 16:41:19,416 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:29 CST)" (scheduled at 2024-11-30 16:41:19.404216+08:00)
2024-11-30 16:41:19,416 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:29 CST)" executed successfully
2024-11-30 16:41:19,477 - DEBUG - Looking for jobs to run
2024-11-30 16:41:19,477 - DEBUG - Next wakeup is due at 2024-11-30 16:41:29.470342+08:00 (in 9.992721 seconds)
2024-11-30 16:41:19,477 - INFO - Running job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:29 CST)" (scheduled at 2024-11-30 16:41:19.470342+08:00)
2024-11-30 16:41:19,477 - INFO - Job "insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:41:29 CST)" executed successfully
2024-11-30 16:41:21,294 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:41:21,294 - INFO - Tortoise-ORM shutdown
2024-11-30 16:42:40,772 - DEBUG - Looking up time zone info from registry
2024-11-30 16:42:40,777 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:42:40,777 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:42:40,777 - INFO - Scheduler started
2024-11-30 16:42:40,778 - DEBUG - Looking for jobs to run
2024-11-30 16:42:40,778 - DEBUG - Next wakeup is due at 2024-11-30 16:42:50.777295+08:00 (in 9.998965 seconds)
2024-11-30 16:42:41,765 - DEBUG - Looking up time zone info from registry
2024-11-30 16:42:41,770 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:42:41,770 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:42:41,770 - INFO - Scheduler started
2024-11-30 16:42:41,771 - DEBUG - Looking for jobs to run
2024-11-30 16:42:41,771 - DEBUG - Next wakeup is due at 2024-11-30 16:42:51.770190+08:00 (in 9.999000 seconds)
2024-11-30 16:42:41,779 - DEBUG - Using selector: SelectSelector
2024-11-30 16:42:41,838 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:42:41,838 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:42:41,838 - INFO - Scheduler started
2024-11-30 16:42:41,838 - DEBUG - Looking for jobs to run
2024-11-30 16:42:41,838 - DEBUG - Next wakeup is due at 2024-11-30 16:42:51.837038+08:00 (in 9.999000 seconds)
2024-11-30 16:42:41,839 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:42:41,999 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001A45864FF90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:42:41,999 - INFO - Tortoise-ORM generating schema
2024-11-30 16:42:42,001 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:42:42,009 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:42:42,010 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001A45812F810> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:42:42,010 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:42:50,791 - DEBUG - Looking for jobs to run
2024-11-30 16:42:50,792 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:42:50 CST)" (scheduled at 2024-11-30 16:42:50.777295+08:00)
2024-11-30 16:42:50,792 - DEBUG - Next wakeup is due at 2024-11-30 16:43:00.777295+08:00 (in 9.984502 seconds)
2024-11-30 16:42:50,792 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:42:50,798 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:00 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:42:51,784 - DEBUG - Looking for jobs to run
2024-11-30 16:42:51,784 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:42:51 CST)" (scheduled at 2024-11-30 16:42:51.770190+08:00)
2024-11-30 16:42:51,784 - DEBUG - Next wakeup is due at 2024-11-30 16:43:01.770190+08:00 (in 9.986031 seconds)
2024-11-30 16:42:51,785 - DEBUG - Using selector: SelectSelector
2024-11-30 16:42:51,786 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:42:51,797 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:01 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 209, in execute_query
    await cursor.execute(query, values)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 728, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 522, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
RuntimeError: Task <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-6' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:42:51,846 - DEBUG - Looking for jobs to run
2024-11-30 16:42:51,846 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:42:51 CST)" (scheduled at 2024-11-30 16:42:51.837038+08:00)
2024-11-30 16:42:51,846 - DEBUG - Next wakeup is due at 2024-11-30 16:43:01.837038+08:00 (in 9.990390 seconds)
2024-11-30 16:42:51,846 - DEBUG - Using selector: SelectSelector
2024-11-30 16:42:51,848 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:42:51,851 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:01 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-9' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-10' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:00,782 - DEBUG - Looking for jobs to run
2024-11-30 16:43:00,782 - DEBUG - Next wakeup is due at 2024-11-30 16:43:10.777295+08:00 (in 9.994322 seconds)
2024-11-30 16:43:00,782 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:10 CST)" (scheduled at 2024-11-30 16:43:00.777295+08:00)
2024-11-30 16:43:00,782 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:00,786 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:10 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:01,779 - DEBUG - Looking for jobs to run
2024-11-30 16:43:01,779 - DEBUG - Next wakeup is due at 2024-11-30 16:43:11.770190+08:00 (in 9.990554 seconds)
2024-11-30 16:43:01,779 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:11 CST)" (scheduled at 2024-11-30 16:43:01.770190+08:00)
2024-11-30 16:43:01,780 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:01,782 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:01,786 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:11 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-13' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-14' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:01,842 - DEBUG - Looking for jobs to run
2024-11-30 16:43:01,842 - DEBUG - Next wakeup is due at 2024-11-30 16:43:11.837038+08:00 (in 9.994075 seconds)
2024-11-30 16:43:01,842 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:11 CST)" (scheduled at 2024-11-30 16:43:01.837038+08:00)
2024-11-30 16:43:01,843 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:01,845 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:01,850 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:11 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-17' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-18' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:10,778 - DEBUG - Looking for jobs to run
2024-11-30 16:43:10,778 - DEBUG - Next wakeup is due at 2024-11-30 16:43:20.777295+08:00 (in 9.999180 seconds)
2024-11-30 16:43:10,779 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:20 CST)" (scheduled at 2024-11-30 16:43:10.777295+08:00)
2024-11-30 16:43:10,779 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:10,780 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:20 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:11,777 - DEBUG - Looking for jobs to run
2024-11-30 16:43:11,778 - DEBUG - Next wakeup is due at 2024-11-30 16:43:21.770190+08:00 (in 9.991860 seconds)
2024-11-30 16:43:11,778 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:21 CST)" (scheduled at 2024-11-30 16:43:11.770190+08:00)
2024-11-30 16:43:11,778 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:11,779 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:11,781 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:21 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-21' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-22' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:11,844 - DEBUG - Looking for jobs to run
2024-11-30 16:43:11,844 - DEBUG - Next wakeup is due at 2024-11-30 16:43:21.837038+08:00 (in 9.992122 seconds)
2024-11-30 16:43:11,844 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:21 CST)" (scheduled at 2024-11-30 16:43:11.837038+08:00)
2024-11-30 16:43:11,844 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:11,844 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:11,849 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:21 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-25' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-26' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:20,784 - DEBUG - Looking for jobs to run
2024-11-30 16:43:20,784 - DEBUG - Next wakeup is due at 2024-11-30 16:43:30.777295+08:00 (in 9.992697 seconds)
2024-11-30 16:43:20,784 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:30 CST)" (scheduled at 2024-11-30 16:43:20.777295+08:00)
2024-11-30 16:43:20,784 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:20,788 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:30 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:21,775 - DEBUG - Looking for jobs to run
2024-11-30 16:43:21,775 - DEBUG - Next wakeup is due at 2024-11-30 16:43:31.770190+08:00 (in 9.994204 seconds)
2024-11-30 16:43:21,775 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:31 CST)" (scheduled at 2024-11-30 16:43:21.770190+08:00)
2024-11-30 16:43:21,775 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:21,777 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:21,779 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:31 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-29' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-30' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:21,846 - DEBUG - Looking for jobs to run
2024-11-30 16:43:21,846 - DEBUG - Next wakeup is due at 2024-11-30 16:43:31.837038+08:00 (in 9.990322 seconds)
2024-11-30 16:43:21,846 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:31 CST)" (scheduled at 2024-11-30 16:43:21.837038+08:00)
2024-11-30 16:43:21,846 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:21,848 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:21,849 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:31 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-33' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-34' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:30,801 - DEBUG - Looking for jobs to run
2024-11-30 16:43:30,801 - DEBUG - Next wakeup is due at 2024-11-30 16:43:40.777295+08:00 (in 9.975751 seconds)
2024-11-30 16:43:30,801 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:40 CST)" (scheduled at 2024-11-30 16:43:30.777295+08:00)
2024-11-30 16:43:30,801 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:30,804 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:40 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:31,790 - DEBUG - Looking for jobs to run
2024-11-30 16:43:31,790 - DEBUG - Next wakeup is due at 2024-11-30 16:43:41.770190+08:00 (in 9.979804 seconds)
2024-11-30 16:43:31,790 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:41 CST)" (scheduled at 2024-11-30 16:43:31.770190+08:00)
2024-11-30 16:43:31,790 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:31,790 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:31,793 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:41 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-37' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-38' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:31,842 - DEBUG - Looking for jobs to run
2024-11-30 16:43:31,842 - DEBUG - Next wakeup is due at 2024-11-30 16:43:41.837038+08:00 (in 9.994509 seconds)
2024-11-30 16:43:31,842 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:41 CST)" (scheduled at 2024-11-30 16:43:31.837038+08:00)
2024-11-30 16:43:31,842 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:31,843 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:31,845 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:41 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-41' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-42' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:40,779 - DEBUG - Looking for jobs to run
2024-11-30 16:43:40,779 - DEBUG - Next wakeup is due at 2024-11-30 16:43:50.777295+08:00 (in 9.997331 seconds)
2024-11-30 16:43:40,780 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:50 CST)" (scheduled at 2024-11-30 16:43:40.777295+08:00)
2024-11-30 16:43:40,780 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:40,782 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:50 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:41,776 - DEBUG - Looking for jobs to run
2024-11-30 16:43:41,776 - DEBUG - Next wakeup is due at 2024-11-30 16:43:51.770190+08:00 (in 9.993855 seconds)
2024-11-30 16:43:41,776 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:51 CST)" (scheduled at 2024-11-30 16:43:41.770190+08:00)
2024-11-30 16:43:41,776 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:41,777 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:41,779 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:51 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-45' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-46' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:41,850 - DEBUG - Looking for jobs to run
2024-11-30 16:43:41,850 - DEBUG - Next wakeup is due at 2024-11-30 16:43:51.837038+08:00 (in 9.986283 seconds)
2024-11-30 16:43:41,850 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:51 CST)" (scheduled at 2024-11-30 16:43:41.837038+08:00)
2024-11-30 16:43:41,850 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:41,850 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:41,854 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:43:51 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-49' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-50' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:50,791 - DEBUG - Looking for jobs to run
2024-11-30 16:43:50,791 - DEBUG - Next wakeup is due at 2024-11-30 16:44:00.777295+08:00 (in 9.985861 seconds)
2024-11-30 16:43:50,791 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:00 CST)" (scheduled at 2024-11-30 16:43:50.777295+08:00)
2024-11-30 16:43:50,792 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:43:50,794 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:00 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:43:51,783 - DEBUG - Looking for jobs to run
2024-11-30 16:43:51,783 - DEBUG - Next wakeup is due at 2024-11-30 16:44:01.770190+08:00 (in 9.986563 seconds)
2024-11-30 16:43:51,783 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:01 CST)" (scheduled at 2024-11-30 16:43:51.770190+08:00)
2024-11-30 16:43:51,783 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:51,784 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:51,787 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:01 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-53' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-54' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:51,845 - DEBUG - Looking for jobs to run
2024-11-30 16:43:51,845 - DEBUG - Next wakeup is due at 2024-11-30 16:44:01.837038+08:00 (in 9.991689 seconds)
2024-11-30 16:43:51,845 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:01 CST)" (scheduled at 2024-11-30 16:43:51.837038+08:00)
2024-11-30 16:43:51,846 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:51,847 - DEBUG - SELECT `password`,`username`,`avatar`,`number`,`id` FROM `user`: None
2024-11-30 16:43:51,850 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:01 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 25, in run_insert_data
    asyncio.run(insert_data())  # 使用 asyncio.run() 来执行异步任务
    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-57' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-58' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:43:56,484 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:43:56,485 - INFO - Tortoise-ORM shutdown
2024-11-30 16:43:57,563 - DEBUG - Looking up time zone info from registry
2024-11-30 16:43:57,568 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:43:57,568 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:43:57,568 - INFO - Scheduler started
2024-11-30 16:43:57,569 - DEBUG - Looking for jobs to run
2024-11-30 16:43:57,569 - DEBUG - Next wakeup is due at 2024-11-30 16:44:07.568460+08:00 (in 9.998999 seconds)
2024-11-30 16:43:57,576 - DEBUG - Using selector: SelectSelector
2024-11-30 16:43:57,636 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:43:57,636 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:43:57,636 - INFO - Scheduler started
2024-11-30 16:43:57,637 - DEBUG - Looking for jobs to run
2024-11-30 16:43:57,637 - DEBUG - Next wakeup is due at 2024-11-30 16:44:07.636102+08:00 (in 9.998993 seconds)
2024-11-30 16:43:57,637 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:43:57,799 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000297A34DBC90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:43:57,799 - INFO - Tortoise-ORM generating schema
2024-11-30 16:43:57,801 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:43:57,807 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:43:57,808 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000297C1A8A110> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:43:57,808 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:44:00,345 - DEBUG - Looking up time zone info from registry
2024-11-30 16:44:00,349 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:44:00,350 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:44:00,350 - INFO - Scheduler started
2024-11-30 16:44:00,351 - DEBUG - Looking for jobs to run
2024-11-30 16:44:00,351 - DEBUG - Next wakeup is due at 2024-11-30 16:44:10.349698+08:00 (in 9.997999 seconds)
2024-11-30 16:44:01,316 - DEBUG - Looking up time zone info from registry
2024-11-30 16:44:01,320 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:44:01,320 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:44:01,321 - INFO - Scheduler started
2024-11-30 16:44:01,322 - DEBUG - Looking for jobs to run
2024-11-30 16:44:01,322 - DEBUG - Next wakeup is due at 2024-11-30 16:44:11.320927+08:00 (in 9.998393 seconds)
2024-11-30 16:44:01,329 - DEBUG - Using selector: SelectSelector
2024-11-30 16:44:01,387 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:44:01,387 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:44:01,387 - INFO - Scheduler started
2024-11-30 16:44:01,388 - DEBUG - Looking for jobs to run
2024-11-30 16:44:01,388 - DEBUG - Next wakeup is due at 2024-11-30 16:44:11.387159+08:00 (in 9.999000 seconds)
2024-11-30 16:44:01,388 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:44:01,552 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000025163FAF790>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:44:01,553 - INFO - Tortoise-ORM generating schema
2024-11-30 16:44:01,555 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:44:01,564 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:44:01,565 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000025163D3B510> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:44:01,565 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:44:10,364 - DEBUG - Looking for jobs to run
2024-11-30 16:44:10,365 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:10 CST)" (scheduled at 2024-11-30 16:44:10.349698+08:00)
2024-11-30 16:44:10,365 - DEBUG - Next wakeup is due at 2024-11-30 16:44:20.349698+08:00 (in 9.984664 seconds)
2024-11-30 16:44:10,373 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:20 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:11,328 - DEBUG - Looking for jobs to run
2024-11-30 16:44:11,329 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:11 CST)" (scheduled at 2024-11-30 16:44:11.320927+08:00)
2024-11-30 16:44:11,329 - DEBUG - Next wakeup is due at 2024-11-30 16:44:21.320927+08:00 (in 9.991466 seconds)
2024-11-30 16:44:11,331 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:21 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:11,390 - DEBUG - Looking for jobs to run
2024-11-30 16:44:11,390 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:11 CST)" (scheduled at 2024-11-30 16:44:11.387159+08:00)
2024-11-30 16:44:11,390 - DEBUG - Next wakeup is due at 2024-11-30 16:44:21.387159+08:00 (in 9.996593 seconds)
2024-11-30 16:44:11,391 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:21 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:44:20,352 - DEBUG - Looking for jobs to run
2024-11-30 16:44:20,352 - DEBUG - Next wakeup is due at 2024-11-30 16:44:30.349698+08:00 (in 9.997132 seconds)
2024-11-30 16:44:20,352 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:30 CST)" (scheduled at 2024-11-30 16:44:20.349698+08:00)
2024-11-30 16:44:20,353 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:30 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:21,333 - DEBUG - Looking for jobs to run
2024-11-30 16:44:21,334 - DEBUG - Next wakeup is due at 2024-11-30 16:44:31.320927+08:00 (in 9.987238 seconds)
2024-11-30 16:44:21,334 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:31 CST)" (scheduled at 2024-11-30 16:44:21.320927+08:00)
2024-11-30 16:44:21,336 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:31 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:21,394 - DEBUG - Looking for jobs to run
2024-11-30 16:44:21,394 - DEBUG - Next wakeup is due at 2024-11-30 16:44:31.387159+08:00 (in 9.992632 seconds)
2024-11-30 16:44:21,394 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:31 CST)" (scheduled at 2024-11-30 16:44:21.387159+08:00)
2024-11-30 16:44:21,395 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:31 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:44:30,357 - DEBUG - Looking for jobs to run
2024-11-30 16:44:30,357 - DEBUG - Next wakeup is due at 2024-11-30 16:44:40.349698+08:00 (in 9.992644 seconds)
2024-11-30 16:44:30,357 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:40 CST)" (scheduled at 2024-11-30 16:44:30.349698+08:00)
2024-11-30 16:44:30,358 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:40 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:31,336 - DEBUG - Looking for jobs to run
2024-11-30 16:44:31,336 - DEBUG - Next wakeup is due at 2024-11-30 16:44:41.320927+08:00 (in 9.984316 seconds)
2024-11-30 16:44:31,336 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:41 CST)" (scheduled at 2024-11-30 16:44:31.320927+08:00)
2024-11-30 16:44:31,337 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:41 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:31,402 - DEBUG - Looking for jobs to run
2024-11-30 16:44:31,402 - DEBUG - Next wakeup is due at 2024-11-30 16:44:41.387159+08:00 (in 9.984528 seconds)
2024-11-30 16:44:31,402 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:41 CST)" (scheduled at 2024-11-30 16:44:31.387159+08:00)
2024-11-30 16:44:31,403 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:41 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:44:31,798 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:44:31,798 - INFO - Tortoise-ORM shutdown
2024-11-30 16:44:32,866 - DEBUG - Looking up time zone info from registry
2024-11-30 16:44:32,866 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:44:32,866 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:44:32,866 - INFO - Scheduler started
2024-11-30 16:44:32,882 - DEBUG - Looking for jobs to run
2024-11-30 16:44:32,882 - DEBUG - Next wakeup is due at 2024-11-30 16:44:42.866484+08:00 (in 9.984351 seconds)
2024-11-30 16:44:32,883 - DEBUG - Using selector: SelectSelector
2024-11-30 16:44:32,949 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:44:32,949 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:44:32,949 - INFO - Scheduler started
2024-11-30 16:44:32,950 - DEBUG - Looking for jobs to run
2024-11-30 16:44:32,950 - DEBUG - Next wakeup is due at 2024-11-30 16:44:42.949550+08:00 (in 9.999181 seconds)
2024-11-30 16:44:32,950 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:44:33,115 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000255D795FED0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:44:33,115 - INFO - Tortoise-ORM generating schema
2024-11-30 16:44:33,117 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:44:33,125 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:44:33,125 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000255D736FA50> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:44:33,125 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:44:40,355 - DEBUG - Looking for jobs to run
2024-11-30 16:44:40,355 - DEBUG - Next wakeup is due at 2024-11-30 16:44:50.349698+08:00 (in 9.994037 seconds)
2024-11-30 16:44:40,355 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:50 CST)" (scheduled at 2024-11-30 16:44:40.349698+08:00)
2024-11-30 16:44:40,356 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:50 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:42,873 - DEBUG - Looking for jobs to run
2024-11-30 16:44:42,873 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:42 CST)" (scheduled at 2024-11-30 16:44:42.866484+08:00)
2024-11-30 16:44:42,874 - DEBUG - Next wakeup is due at 2024-11-30 16:44:52.866484+08:00 (in 9.992322 seconds)
2024-11-30 16:44:42,875 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:52 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:42,957 - DEBUG - Looking for jobs to run
2024-11-30 16:44:42,962 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:42 CST)" (scheduled at 2024-11-30 16:44:42.949550+08:00)
2024-11-30 16:44:42,962 - DEBUG - Next wakeup is due at 2024-11-30 16:44:52.949550+08:00 (in 9.987058 seconds)
2024-11-30 16:44:42,963 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:44:52 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:44:50,356 - DEBUG - Looking for jobs to run
2024-11-30 16:44:50,356 - DEBUG - Next wakeup is due at 2024-11-30 16:45:00.349698+08:00 (in 9.993525 seconds)
2024-11-30 16:44:50,356 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:00 CST)" (scheduled at 2024-11-30 16:44:50.349698+08:00)
2024-11-30 16:44:50,357 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:00 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:52,878 - DEBUG - Looking for jobs to run
2024-11-30 16:44:52,878 - DEBUG - Next wakeup is due at 2024-11-30 16:45:02.866484+08:00 (in 9.987847 seconds)
2024-11-30 16:44:52,878 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:02 CST)" (scheduled at 2024-11-30 16:44:52.866484+08:00)
2024-11-30 16:44:52,879 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:02 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:44:52,957 - DEBUG - Looking for jobs to run
2024-11-30 16:44:52,957 - DEBUG - Next wakeup is due at 2024-11-30 16:45:02.949550+08:00 (in 9.992209 seconds)
2024-11-30 16:44:52,957 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:02 CST)" (scheduled at 2024-11-30 16:44:52.949550+08:00)
2024-11-30 16:44:52,958 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:02 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:45:00,362 - DEBUG - Looking for jobs to run
2024-11-30 16:45:00,362 - DEBUG - Next wakeup is due at 2024-11-30 16:45:10.349698+08:00 (in 9.986975 seconds)
2024-11-30 16:45:00,362 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:10 CST)" (scheduled at 2024-11-30 16:45:00.349698+08:00)
2024-11-30 16:45:00,362 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:10 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.get_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:45:02,874 - DEBUG - Looking for jobs to run
2024-11-30 16:45:02,874 - DEBUG - Next wakeup is due at 2024-11-30 16:45:12.866484+08:00 (in 9.991881 seconds)
2024-11-30 16:45:02,874 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:12 CST)" (scheduled at 2024-11-30 16:45:02.866484+08:00)
2024-11-30 16:45:02,875 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:12 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.new_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:45:02,951 - DEBUG - Looking for jobs to run
2024-11-30 16:45:02,952 - DEBUG - Next wakeup is due at 2024-11-30 16:45:12.949550+08:00 (in 9.997464 seconds)
2024-11-30 16:45:02,952 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:12 CST)" (scheduled at 2024-11-30 16:45:02.949550+08:00)
2024-11-30 16:45:02,952 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:12 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.new_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-1_0'.
2024-11-30 16:45:03,252 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:45:03,252 - INFO - Tortoise-ORM shutdown
2024-11-30 16:45:04,502 - DEBUG - Looking up time zone info from registry
2024-11-30 16:45:10,353 - DEBUG - Looking for jobs to run
2024-11-30 16:45:10,353 - DEBUG - Next wakeup is due at 2024-11-30 16:45:20.349698+08:00 (in 9.995985 seconds)
2024-11-30 16:45:10,353 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:20 CST)" (scheduled at 2024-11-30 16:45:10.349698+08:00)
2024-11-30 16:45:10,355 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:20 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 26, in run_insert_data
    loop = asyncio.new_event_loop()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 677, in get_event_loop
    raise RuntimeError('There is no current event loop in thread %r.'
RuntimeError: There is no current event loop in thread 'ThreadPoolExecutor-0_0'.
2024-11-30 16:45:20,132 - DEBUG - Looking up time zone info from registry
2024-11-30 16:45:20,136 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:45:20,136 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:45:20,136 - INFO - Scheduler started
2024-11-30 16:45:20,138 - DEBUG - Looking for jobs to run
2024-11-30 16:45:20,138 - DEBUG - Next wakeup is due at 2024-11-30 16:45:30.136167+08:00 (in 9.997999 seconds)
2024-11-30 16:45:21,131 - DEBUG - Looking up time zone info from registry
2024-11-30 16:45:21,136 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:45:21,136 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:45:21,136 - INFO - Scheduler started
2024-11-30 16:45:21,137 - DEBUG - Looking for jobs to run
2024-11-30 16:45:21,137 - DEBUG - Next wakeup is due at 2024-11-30 16:45:31.136914+08:00 (in 9.999009 seconds)
2024-11-30 16:45:21,145 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:21,203 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:45:21,203 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:45:21,203 - INFO - Scheduler started
2024-11-30 16:45:21,203 - DEBUG - Looking for jobs to run
2024-11-30 16:45:21,203 - DEBUG - Next wakeup is due at 2024-11-30 16:45:31.203800+08:00 (in 10.000000 seconds)
2024-11-30 16:45:21,204 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:45:21,364 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000015D6F97BE50>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:45:21,364 - INFO - Tortoise-ORM generating schema
2024-11-30 16:45:21,366 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:45:21,374 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:45:21,374 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000015D6F700FD0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:45:21,374 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:45:30,150 - DEBUG - Looking for jobs to run
2024-11-30 16:45:30,151 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:30 CST)" (scheduled at 2024-11-30 16:45:30.136167+08:00)
2024-11-30 16:45:30,151 - DEBUG - Next wakeup is due at 2024-11-30 16:45:40.136167+08:00 (in 9.984952 seconds)
2024-11-30 16:45:30,151 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:45:30,152 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:40 CST)" executed successfully
2024-11-30 16:45:31,147 - DEBUG - Looking for jobs to run
2024-11-30 16:45:31,148 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:31 CST)" (scheduled at 2024-11-30 16:45:31.136914+08:00)
2024-11-30 16:45:31,148 - DEBUG - Next wakeup is due at 2024-11-30 16:45:41.136914+08:00 (in 9.988522 seconds)
2024-11-30 16:45:31,148 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:31,149 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:41 CST)" executed successfully
2024-11-30 16:45:31,209 - DEBUG - Looking for jobs to run
2024-11-30 16:45:31,209 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:31 CST)" (scheduled at 2024-11-30 16:45:31.203800+08:00)
2024-11-30 16:45:31,209 - DEBUG - Next wakeup is due at 2024-11-30 16:45:41.203800+08:00 (in 9.994132 seconds)
2024-11-30 16:45:31,210 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:31,211 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:41 CST)" executed successfully
2024-11-30 16:45:40,146 - DEBUG - Looking for jobs to run
2024-11-30 16:45:40,146 - DEBUG - Next wakeup is due at 2024-11-30 16:45:50.136167+08:00 (in 9.989379 seconds)
2024-11-30 16:45:40,147 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:50 CST)" (scheduled at 2024-11-30 16:45:40.136167+08:00)
2024-11-30 16:45:40,147 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:45:40,148 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:50 CST)" executed successfully
2024-11-30 16:45:41,142 - DEBUG - Looking for jobs to run
2024-11-30 16:45:41,142 - DEBUG - Next wakeup is due at 2024-11-30 16:45:51.136914+08:00 (in 9.994209 seconds)
2024-11-30 16:45:41,142 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:51 CST)" (scheduled at 2024-11-30 16:45:41.136914+08:00)
2024-11-30 16:45:41,142 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:41,144 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:51 CST)" executed successfully
2024-11-30 16:45:41,219 - DEBUG - Looking for jobs to run
2024-11-30 16:45:41,219 - DEBUG - Next wakeup is due at 2024-11-30 16:45:51.203800+08:00 (in 9.984218 seconds)
2024-11-30 16:45:41,219 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:51 CST)" (scheduled at 2024-11-30 16:45:41.203800+08:00)
2024-11-30 16:45:41,220 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:41,221 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:45:51 CST)" executed successfully
2024-11-30 16:45:50,145 - DEBUG - Looking for jobs to run
2024-11-30 16:45:50,145 - DEBUG - Next wakeup is due at 2024-11-30 16:46:00.136167+08:00 (in 9.990496 seconds)
2024-11-30 16:45:50,145 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:00 CST)" (scheduled at 2024-11-30 16:45:50.136167+08:00)
2024-11-30 16:45:50,145 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:45:50,145 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:00 CST)" executed successfully
2024-11-30 16:45:51,143 - DEBUG - Looking for jobs to run
2024-11-30 16:45:51,143 - DEBUG - Next wakeup is due at 2024-11-30 16:46:01.136914+08:00 (in 9.993845 seconds)
2024-11-30 16:45:51,143 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:01 CST)" (scheduled at 2024-11-30 16:45:51.136914+08:00)
2024-11-30 16:45:51,143 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:51,144 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:01 CST)" executed successfully
2024-11-30 16:45:51,206 - DEBUG - Looking for jobs to run
2024-11-30 16:45:51,206 - DEBUG - Next wakeup is due at 2024-11-30 16:46:01.203800+08:00 (in 9.997322 seconds)
2024-11-30 16:45:51,206 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:01 CST)" (scheduled at 2024-11-30 16:45:51.203800+08:00)
2024-11-30 16:45:51,206 - DEBUG - Using selector: SelectSelector
2024-11-30 16:45:51,206 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:01 CST)" executed successfully
2024-11-30 16:46:00,144 - DEBUG - Looking for jobs to run
2024-11-30 16:46:00,144 - DEBUG - Next wakeup is due at 2024-11-30 16:46:10.136167+08:00 (in 9.991837 seconds)
2024-11-30 16:46:00,144 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:10 CST)" (scheduled at 2024-11-30 16:46:00.136167+08:00)
2024-11-30 16:46:00,144 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:46:00,145 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:10 CST)" executed successfully
2024-11-30 16:46:01,139 - DEBUG - Looking for jobs to run
2024-11-30 16:46:01,139 - DEBUG - Next wakeup is due at 2024-11-30 16:46:11.136914+08:00 (in 9.997591 seconds)
2024-11-30 16:46:01,139 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:11 CST)" (scheduled at 2024-11-30 16:46:01.136914+08:00)
2024-11-30 16:46:01,140 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:01,140 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:11 CST)" executed successfully
2024-11-30 16:46:01,216 - DEBUG - Looking for jobs to run
2024-11-30 16:46:01,216 - DEBUG - Next wakeup is due at 2024-11-30 16:46:11.203800+08:00 (in 9.987357 seconds)
2024-11-30 16:46:01,216 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:11 CST)" (scheduled at 2024-11-30 16:46:01.203800+08:00)
2024-11-30 16:46:01,216 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:01,217 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:11 CST)" executed successfully
2024-11-30 16:46:10,147 - DEBUG - Looking for jobs to run
2024-11-30 16:46:10,147 - DEBUG - Next wakeup is due at 2024-11-30 16:46:20.136167+08:00 (in 9.988803 seconds)
2024-11-30 16:46:10,147 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:20 CST)" (scheduled at 2024-11-30 16:46:10.136167+08:00)
2024-11-30 16:46:10,147 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:46:10,148 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:20 CST)" executed successfully
2024-11-30 16:46:11,140 - DEBUG - Looking for jobs to run
2024-11-30 16:46:11,140 - DEBUG - Next wakeup is due at 2024-11-30 16:46:21.136914+08:00 (in 9.996086 seconds)
2024-11-30 16:46:11,140 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:21 CST)" (scheduled at 2024-11-30 16:46:11.136914+08:00)
2024-11-30 16:46:11,140 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:11,141 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:21 CST)" executed successfully
2024-11-30 16:46:11,217 - DEBUG - Looking for jobs to run
2024-11-30 16:46:11,217 - DEBUG - Next wakeup is due at 2024-11-30 16:46:21.203800+08:00 (in 9.985912 seconds)
2024-11-30 16:46:11,217 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:21 CST)" (scheduled at 2024-11-30 16:46:11.203800+08:00)
2024-11-30 16:46:11,217 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:11,219 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:21 CST)" executed successfully
2024-11-30 16:46:20,139 - DEBUG - Looking for jobs to run
2024-11-30 16:46:20,139 - DEBUG - Next wakeup is due at 2024-11-30 16:46:30.136167+08:00 (in 9.996976 seconds)
2024-11-30 16:46:20,139 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:30 CST)" (scheduled at 2024-11-30 16:46:20.136167+08:00)
2024-11-30 16:46:20,139 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:46:20,140 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:30 CST)" executed successfully
2024-11-30 16:46:21,152 - DEBUG - Looking for jobs to run
2024-11-30 16:46:21,152 - DEBUG - Next wakeup is due at 2024-11-30 16:46:31.136914+08:00 (in 9.984389 seconds)
2024-11-30 16:46:21,152 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:31 CST)" (scheduled at 2024-11-30 16:46:21.136914+08:00)
2024-11-30 16:46:21,153 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:21,153 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:31 CST)" executed successfully
2024-11-30 16:46:21,214 - DEBUG - Looking for jobs to run
2024-11-30 16:46:21,214 - DEBUG - Next wakeup is due at 2024-11-30 16:46:31.203800+08:00 (in 9.988903 seconds)
2024-11-30 16:46:21,214 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:31 CST)" (scheduled at 2024-11-30 16:46:21.203800+08:00)
2024-11-30 16:46:21,214 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:21,216 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:31 CST)" executed successfully
2024-11-30 16:46:30,150 - DEBUG - Looking for jobs to run
2024-11-30 16:46:30,150 - DEBUG - Next wakeup is due at 2024-11-30 16:46:40.136167+08:00 (in 9.985401 seconds)
2024-11-30 16:46:30,150 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:40 CST)" (scheduled at 2024-11-30 16:46:30.136167+08:00)
2024-11-30 16:46:30,151 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:46:30,151 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:40 CST)" executed successfully
2024-11-30 16:46:31,147 - DEBUG - Looking for jobs to run
2024-11-30 16:46:31,147 - DEBUG - Next wakeup is due at 2024-11-30 16:46:41.136914+08:00 (in 9.988955 seconds)
2024-11-30 16:46:31,147 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:41 CST)" (scheduled at 2024-11-30 16:46:31.136914+08:00)
2024-11-30 16:46:31,148 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:31,148 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:41 CST)" executed successfully
2024-11-30 16:46:31,209 - DEBUG - Looking for jobs to run
2024-11-30 16:46:31,209 - DEBUG - Next wakeup is due at 2024-11-30 16:46:41.203800+08:00 (in 9.994668 seconds)
2024-11-30 16:46:31,209 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:41 CST)" (scheduled at 2024-11-30 16:46:31.203800+08:00)
2024-11-30 16:46:31,209 - DEBUG - Using selector: SelectSelector
2024-11-30 16:46:31,210 - INFO - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:46:41 CST)" executed successfully
2024-11-30 16:46:32,542 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:46:32,543 - INFO - Tortoise-ORM shutdown
2024-11-30 16:46:32,565 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,567 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-6' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,567 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-7' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-8' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-9' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-10' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-11' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-12' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,568 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-13' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,569 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-14' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,569 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-15' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,569 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-16' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,570 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-17' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,570 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-18' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,670 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-1' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,673 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-2' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,673 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-3' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,674 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-4' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,674 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,674 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-6' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:46:32,675 - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-7' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93>>
2024-11-30 16:47:51,005 - DEBUG - Using selector: SelectSelector
2024-11-30 16:47:51,065 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:47:51,227 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000264D07EC750>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:47:51,227 - INFO - Tortoise-ORM generating schema
2024-11-30 16:47:51,230 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:47:51,237 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:47:51,238 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000264EEB03590> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:47:51,238 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 16:48:00,676 - DEBUG - SELECT `username`,`id`,`password`,`avatar`,`number` FROM `user`: None
2024-11-30 16:48:00,676 - DEBUG - SELECT `site`.`picture`,`site`.`location`,`site`.`ticket`,`site`.`name`,`site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`time_reference`,`site`.`longitude`,`site`.`transport`,`site`.`latitude`,`site`.`type`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:48:00,679 - DEBUG - SELECT `site`.`picture`,`site`.`location`,`site`.`ticket`,`site`.`name`,`site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`time_reference`,`site`.`longitude`,`site`.`transport`,`site`.`latitude`,`site`.`type`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:48:00,680 - DEBUG - SELECT `site`.`picture`,`site`.`location`,`site`.`ticket`,`site`.`name`,`site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`time_reference`,`site`.`longitude`,`site`.`transport`,`site`.`latitude`,`site`.`type`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:48:00,680 - DEBUG - SELECT `site`.`picture`,`site`.`location`,`site`.`ticket`,`site`.`name`,`site`.`open_time`,`site`.`id`,`site`.`description`,`site`.`time_reference`,`site`.`longitude`,`site`.`transport`,`site`.`latitude`,`site`.`type`,`site`.`city`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:48:00,680 - INFO - [(1, 2, 3, 4, 7, 8), (3, 4, 8)]
2024-11-30 16:48:00,680 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,680 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*', 10]
2024-11-30 16:48:00,690 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,690 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '4*', 11]
2024-11-30 16:48:00,690 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,695 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*', 10]
2024-11-30 16:48:00,697 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,697 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['7*', '3*']
2024-11-30 16:48:00,699 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,699 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*', 19]
2024-11-30 16:48:00,701 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,701 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '4*', 10]
2024-11-30 16:48:00,701 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,701 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*', 11]
2024-11-30 16:48:00,705 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,705 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*', 11]
2024-11-30 16:48:00,705 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,705 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '4*', 19]
2024-11-30 16:48:00,705 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,709 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*4*', 10]
2024-11-30 16:48:00,709 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:48:00,709 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*', '4*', 13]
2024-11-30 16:48:00,712 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:48:00,712 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*', '3*', 14]
2024-11-30 16:48:00,712 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,713 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '3*4*', 19]
2024-11-30 16:48:00,713 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:48:00,713 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['3*7*', '4*']
2024-11-30 16:48:00,713 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:48:00,713 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['4*7*', '3*']
2024-11-30 16:48:00,713 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,713 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*7*', '3*']
2024-11-30 16:48:00,721 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,721 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*', 22]
2024-11-30 16:48:00,722 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,722 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*3*', 10]
2024-11-30 16:48:00,725 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:48:00,725 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*', '3*']
2024-11-30 16:48:00,725 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:48:00,725 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*', '8*', 13]
2024-11-30 16:48:00,729 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,729 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*3*', 19]
2024-11-30 16:48:00,730 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:48:00,730 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*7*', '3*']
2024-11-30 16:48:00,730 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:48:00,730 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['3*7*', '8*', 20]
2024-11-30 16:48:00,730 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,730 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*4*', 11]
2024-11-30 16:48:00,730 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:48:00,730 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*', '4*']
2024-11-30 16:48:00,737 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:48:00,737 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*', '8*', 16]
2024-11-30 16:48:00,737 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,737 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*4*', 10]
2024-11-30 16:48:00,737 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:48:00,737 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*', '4*', 23]
2024-11-30 16:48:00,737 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:48:00,737 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*', '8*', 14]
2024-11-30 16:48:00,746 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,746 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '4*', 22]
2024-11-30 16:48:00,747 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,747 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*7*', '4*']
2024-11-30 16:48:00,747 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,747 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '4*', 12]
2024-11-30 16:48:00,747 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,747 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*4*', 19]
2024-11-30 16:48:00,747 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:48:00,754 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*7*', '4*', 24]
2024-11-30 16:48:00,755 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:48:00,755 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['4*7*', '8*', 21]
2024-11-30 16:48:00,755 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,755 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '3*', 26]
2024-11-30 16:48:00,755 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,755 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*3*', 11]
2024-11-30 16:48:00,755 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:48:00,755 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*', '3*', 25]
2024-11-30 16:48:00,762 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:48:00,763 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*', '8*', 15]
2024-11-30 16:48:00,763 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,763 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*', 26]
2024-11-30 16:48:00,763 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,763 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*', 12]
2024-11-30 16:48:00,763 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,763 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '3*', 12]
2024-11-30 16:48:00,771 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,771 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*4*', 11]
2024-11-30 16:48:00,772 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:48:00,772 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*', '4*', 15]
2024-11-30 16:48:00,772 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:48:00,772 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*', '3*', 16]
2024-11-30 16:48:00,772 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,772 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*4*', 22]
2024-11-30 16:48:00,772 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:48:00,772 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*7*', '4*']
2024-11-30 16:48:00,779 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,780 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*4*7*', '8*']
2024-11-30 16:48:00,780 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:48:00,780 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*3*4*', 11]
2024-11-30 16:48:00,780 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:48:00,780 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*', '3*4*', 25]
2024-11-30 16:48:00,785 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:48:00,785 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*', '8*4*', 15]
2024-11-30 16:48:00,787 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:48:00,787 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*', '8*3*', 16]
2024-11-30 16:48:00,787 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*3*' LIMIT 2: None
2024-11-30 16:48:00,787 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*3*', '4*']
2024-11-30 16:48:00,787 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*4*' LIMIT 2: None
2024-11-30 16:48:00,787 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*4*', '3*']
2024-11-30 16:48:00,793 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*4*' LIMIT 2: None
2024-11-30 16:48:00,793 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*4*', '8*']
2024-11-30 16:48:00,793 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,795 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*3*', 12]
2024-11-30 16:48:00,796 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:48:00,796 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*', '3*']
2024-11-30 16:48:00,796 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:48:00,796 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*', '8*', 17]
2024-11-30 16:48:00,796 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,796 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*3*', 26]
2024-11-30 16:48:00,796 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:48:00,796 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*7*', '3*']
2024-11-30 16:48:00,804 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:48:00,804 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*7*', '8*']
2024-11-30 16:48:00,804 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,804 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*7*', '4*']
2024-11-30 16:48:00,804 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,804 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*3*', 22]
2024-11-30 16:48:00,809 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:48:00,809 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*7*', '3*', 27]
2024-11-30 16:48:00,812 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,814 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*7*', '8*']
2024-11-30 16:48:00,814 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,814 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*4*', 26]
2024-11-30 16:48:00,814 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:48:00,814 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*7*', '4*', 33]
2024-11-30 16:48:00,819 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:48:00,819 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*4*7*', '8*']
2024-11-30 16:48:00,821 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:48:00,821 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*3*4*', 19]
2024-11-30 16:48:00,822 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:48:00,822 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*7*', '3*4*', 24]
2024-11-30 16:48:00,822 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:48:00,822 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['3*7*', '8*4*', 20]
2024-11-30 16:48:00,822 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:48:00,822 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['4*7*', '8*3*', 21]
2024-11-30 16:48:00,822 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*3*7*' LIMIT 2: None
2024-11-30 16:48:00,829 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*3*7*', '4*']
2024-11-30 16:48:00,830 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*4*7*' LIMIT 2: None
2024-11-30 16:48:00,830 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*4*7*', '3*']
2024-11-30 16:48:00,830 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='3*4*7*' LIMIT 2: None
2024-11-30 16:48:00,830 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['3*4*7*', '8*']
2024-11-30 16:48:00,830 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,834 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*4*', 12]
2024-11-30 16:48:00,834 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:48:00,836 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*', '4*', 32]
2024-11-30 16:48:00,837 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:48:00,837 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*', '8*', 18]
2024-11-30 16:48:00,837 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,837 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '3*', 35]
2024-11-30 16:48:00,837 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,837 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '3*4*', 12]
2024-11-30 16:48:00,837 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:48:00,837 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*', '4*', 17]
2024-11-30 16:48:00,845 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:48:00,846 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*', '3*', 18]
2024-11-30 16:48:00,846 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,846 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '3*4*', 26]
2024-11-30 16:48:00,846 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:48:00,846 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*7*', '4*', 34]
2024-11-30 16:48:00,846 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:48:00,846 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*7*', '3*', 37]
2024-11-30 16:48:00,846 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,846 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*', 35]
2024-11-30 16:48:00,854 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,855 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '3*4*', 22]
2024-11-30 16:48:00,855 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,855 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*7*', '4*', 36]
2024-11-30 16:48:00,855 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,855 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*7*', '3*', 28]
2024-11-30 16:48:00,855 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:48:00,861 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*3*4*', 10]
2024-11-30 16:48:00,862 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:48:00,862 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*', '3*4*', 23]
2024-11-30 16:48:00,862 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:48:00,862 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*', '8*4*', 13]
2024-11-30 16:48:00,862 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:48:00,862 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*', '8*3*', 14]
2024-11-30 16:48:00,862 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*3*' LIMIT 2: None
2024-11-30 16:48:00,869 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*3*', '4*']
2024-11-30 16:48:00,870 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*4*' LIMIT 2: None
2024-11-30 16:48:00,870 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*4*', '3*']
2024-11-30 16:48:00,871 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*4*' LIMIT 2: None
2024-11-30 16:48:00,871 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*4*', '8*']
2024-11-30 16:48:00,871 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:48:00,874 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*3*4*', 26]
2024-11-30 16:48:00,874 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:48:00,874 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*7*', '8*4*', 34]
2024-11-30 16:48:00,874 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:48:00,874 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*7*', '8*3*', 37]
2024-11-30 16:48:00,879 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:48:00,879 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*7*', '3*4*', 33]
2024-11-30 16:48:00,879 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*3*4*7*' LIMIT 2: None
2024-11-30 16:48:00,879 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*4*7*', '8*']
2024-11-30 16:48:00,879 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*3*7*' LIMIT 2: None
2024-11-30 16:48:00,879 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*3*7*', '4*']
2024-11-30 16:48:00,879 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*4*7*' LIMIT 2: None
2024-11-30 16:48:00,886 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*4*7*', '3*']
2024-11-30 16:48:00,887 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:48:00,887 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*3*4*', 12]
2024-11-30 16:48:00,888 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:48:00,888 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*', '8*4*', 17]
2024-11-30 16:48:00,892 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:48:00,892 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*', '8*3*', 18]
2024-11-30 16:48:00,894 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:48:00,894 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*', '3*4*', 32]
2024-11-30 16:48:00,895 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*4*' LIMIT 2: None
2024-11-30 16:48:00,896 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*4*', '8*']
2024-11-30 16:48:00,896 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*3*' LIMIT 2: None
2024-11-30 16:48:00,898 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*3*', '4*']
2024-11-30 16:48:00,900 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*4*' LIMIT 2: None
2024-11-30 16:48:00,900 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*4*', '3*']
2024-11-30 16:48:00,900 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,900 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '3*4*', 35]
2024-11-30 16:48:00,904 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,904 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*7*', '4*']
2024-11-30 16:48:00,905 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,906 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*7*', '3*']
2024-11-30 16:48:00,908 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,908 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*3*', 35]
2024-11-30 16:48:00,910 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,910 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*7*', '8*', 50]
2024-11-30 16:48:00,912 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,913 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*7*', '3*']
2024-11-30 16:48:00,913 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:48:00,915 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*3*4*', 22]
2024-11-30 16:48:00,915 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,915 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*7*', '8*4*', 36]
2024-11-30 16:48:00,915 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,915 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*7*', '8*3*', 28]
2024-11-30 16:48:00,920 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:48:00,921 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*7*', '3*4*', 27]
2024-11-30 16:48:00,921 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='2*3*4*7*' LIMIT 2: None
2024-11-30 16:48:00,921 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*4*7*', '8*']
2024-11-30 16:48:00,921 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,921 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*3*7*', '4*']
2024-11-30 16:48:00,921 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,921 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*4*7*', '3*']
2024-11-30 16:48:00,929 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,929 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*4*', 35]
2024-11-30 16:48:00,930 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,930 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*7*', '8*', 51]
2024-11-30 16:48:00,930 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,930 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*7*', '4*', 52]
2024-11-30 16:48:00,935 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,935 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*3*4*', 35]
2024-11-30 16:48:00,937 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:48:00,937 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*7*', '8*4*', 50]
2024-11-30 16:48:00,938 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:48:00,940 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*7*', '8*3*', 51]
2024-11-30 16:48:00,942 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:48:00,942 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*7*', '3*4*', 52]
2024-11-30 16:48:00,942 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*4*7*' LIMIT 2: None
2024-11-30 16:48:00,942 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*4*7*', '8*']
2024-11-30 16:48:00,946 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*8*' LIMIT 2: None
2024-11-30 16:48:00,947 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*7*8*', '4*']
2024-11-30 16:48:00,947 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*8*' LIMIT 2: None
2024-11-30 16:48:00,949 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*7*8*', '3*']
2024-11-30 16:50:32,683 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:50:32,684 - INFO - Tortoise-ORM shutdown
2024-11-30 16:50:33,776 - DEBUG - Looking up time zone info from registry
2024-11-30 16:50:33,781 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:50:33,781 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:50:33,781 - INFO - Scheduler started
2024-11-30 16:50:33,782 - DEBUG - Looking for jobs to run
2024-11-30 16:50:33,782 - DEBUG - Next wakeup is due at 2024-11-30 16:50:43.781172+08:00 (in 9.999000 seconds)
2024-11-30 16:50:33,789 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:33,850 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:50:33,851 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:50:33,851 - INFO - Scheduler started
2024-11-30 16:50:33,851 - DEBUG - Looking for jobs to run
2024-11-30 16:50:33,851 - DEBUG - Next wakeup is due at 2024-11-30 16:50:43.850877+08:00 (in 9.998981 seconds)
2024-11-30 16:50:33,852 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:50:38,156 - DEBUG - Looking up time zone info from registry
2024-11-30 16:50:38,161 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:50:38,161 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:50:38,161 - INFO - Scheduler started
2024-11-30 16:50:38,163 - DEBUG - Looking for jobs to run
2024-11-30 16:50:38,163 - DEBUG - Next wakeup is due at 2024-11-30 16:50:48.161959+08:00 (in 9.998434 seconds)
2024-11-30 16:50:39,152 - DEBUG - Looking up time zone info from registry
2024-11-30 16:50:39,156 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:50:39,156 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:50:39,156 - INFO - Scheduler started
2024-11-30 16:50:39,157 - DEBUG - Looking for jobs to run
2024-11-30 16:50:39,157 - DEBUG - Next wakeup is due at 2024-11-30 16:50:49.156852+08:00 (in 9.999002 seconds)
2024-11-30 16:50:39,165 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:39,223 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2024-11-30 16:50:39,223 - INFO - Added job "run_insert_data" to job store "default"
2024-11-30 16:50:39,223 - INFO - Scheduler started
2024-11-30 16:50:39,223 - DEBUG - Looking for jobs to run
2024-11-30 16:50:39,223 - DEBUG - Next wakeup is due at 2024-11-30 16:50:49.223139+08:00 (in 9.999497 seconds)
2024-11-30 16:50:39,224 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:50:39,392 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000189EE750D90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:50:39,393 - INFO - Tortoise-ORM generating schema
2024-11-30 16:50:39,395 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:50:39,406 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:50:39,407 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000189FEB42110> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:50:39,407 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:50:48,175 - DEBUG - Looking for jobs to run
2024-11-30 16:50:48,176 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:48 CST)" (scheduled at 2024-11-30 16:50:48.161959+08:00)
2024-11-30 16:50:48,176 - DEBUG - Next wakeup is due at 2024-11-30 16:50:58.161959+08:00 (in 9.985833 seconds)
2024-11-30 16:50:48,176 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:50:48,177 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=TypeError("'NoneType' object is not iterable")>
Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:50:48,180 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:58 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:50:49,171 - DEBUG - Looking for jobs to run
2024-11-30 16:50:49,171 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:49 CST)" (scheduled at 2024-11-30 16:50:49.156852+08:00)
2024-11-30 16:50:49,172 - DEBUG - Next wakeup is due at 2024-11-30 16:50:59.156852+08:00 (in 9.984646 seconds)
2024-11-30 16:50:49,172 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:49,173 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:49,174 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-5' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=RuntimeError("Task <Task pending name='Task-5' coro=<insert_data() running at D:\\桌面\\大三\\计算机设计大赛\\traval-back-end\\src\\utils\\aprioriutils.py:94>> got Future <Task pending name='Task-7' coro=<Pool._wakeup() running at C:\\Users\\罗渲渲\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\aiomysql\\pool.py:203>> attached to a different loop")>
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 209, in execute_query
    await cursor.execute(query, values)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 728, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 522, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
RuntimeError: Task <Task pending name='Task-5' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Task pending name='Task-7' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:49,182 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:50:49,182 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:49,185 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:59 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-6' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-8' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:49,233 - DEBUG - Looking for jobs to run
2024-11-30 16:50:49,233 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:49 CST)" (scheduled at 2024-11-30 16:50:49.223139+08:00)
2024-11-30 16:50:49,233 - DEBUG - Next wakeup is due at 2024-11-30 16:50:59.223139+08:00 (in 9.989919 seconds)
2024-11-30 16:50:49,233 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:49,234 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:49,234 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:49,235 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-9' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=RuntimeError("Task <Task pending name='Task-9' coro=<insert_data() running at D:\\桌面\\大三\\计算机设计大赛\\traval-back-end\\src\\utils\\aprioriutils.py:94>> got Future <Task pending name='Task-12' coro=<Pool._wakeup() running at C:\\Users\\罗渲渲\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\aiomysql\\pool.py:203>> attached to a different loop")>
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 209, in execute_query
    await cursor.execute(query, values)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 728, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 522, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-9' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
RuntimeError: Task <Task pending name='Task-9' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Task pending name='Task-12' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:49,239 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:50:59 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-10' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-11' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:58,174 - DEBUG - Looking for jobs to run
2024-11-30 16:50:58,174 - DEBUG - Next wakeup is due at 2024-11-30 16:51:08.161959+08:00 (in 9.987900 seconds)
2024-11-30 16:50:58,174 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:08 CST)" (scheduled at 2024-11-30 16:50:58.161959+08:00)
2024-11-30 16:50:58,175 - DEBUG - Using proactor: IocpProactor
2024-11-30 16:50:58,176 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-3' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=TypeError("'NoneType' object is not iterable")>
Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:50:58,178 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:08 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
                  ^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1275, in all
    return cls._db_queryset(using_db)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1076, in _db_queryset
    db = using_db or cls._choose_db(for_write)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\models.py", line 1024, in _choose_db
    db = router.db_for_read(cls)
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 36, in db_for_read
    return self._db_route(model, "db_for_read")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 31, in _db_route
    return connections.get(self._router_func(model, action))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\router.py", line 18, in _router_func
    for r in self._routers:
TypeError: 'NoneType' object is not iterable
2024-11-30 16:50:59,168 - DEBUG - Looking for jobs to run
2024-11-30 16:50:59,168 - DEBUG - Next wakeup is due at 2024-11-30 16:51:09.156852+08:00 (in 9.988789 seconds)
2024-11-30 16:50:59,168 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:09 CST)" (scheduled at 2024-11-30 16:50:59.156852+08:00)
2024-11-30 16:50:59,168 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:59,169 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:59,169 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:59,170 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-13' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=RuntimeError("Task <Task pending name='Task-13' coro=<insert_data() running at D:\\桌面\\大三\\计算机设计大赛\\traval-back-end\\src\\utils\\aprioriutils.py:94>> got Future <Task pending name='Task-15' coro=<Pool._wakeup() running at C:\\Users\\罗渲渲\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\aiomysql\\pool.py:203>> attached to a different loop")>
Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-13' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Task pending name='Task-15' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:59,172 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:09 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 209, in execute_query
    await cursor.execute(query, values)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 728, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 522, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-14' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
RuntimeError: Task <Task pending name='Task-14' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-16' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:59,229 - DEBUG - Looking for jobs to run
2024-11-30 16:50:59,229 - DEBUG - Next wakeup is due at 2024-11-30 16:51:09.223139+08:00 (in 9.993748 seconds)
2024-11-30 16:50:59,229 - INFO - Running job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:09 CST)" (scheduled at 2024-11-30 16:50:59.223139+08:00)
2024-11-30 16:50:59,229 - DEBUG - Using selector: SelectSelector
2024-11-30 16:50:59,230 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:59,231 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user`: None
2024-11-30 16:50:59,231 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-17' coro=<insert_data() done, defined at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:93> exception=RuntimeError("Task <Task pending name='Task-17' coro=<insert_data() running at D:\\桌面\\大三\\计算机设计大赛\\traval-back-end\\src\\utils\\aprioriutils.py:94>> got Future <Task pending name='Task-19' coro=<Pool._wakeup() running at C:\\Users\\罗渲渲\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\aiomysql\\pool.py:203>> attached to a different loop")>
Traceback (most recent call last):
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\client.py", line 348, in __aexit__
    await self.pool.release(self.connection)
RuntimeError: Task <Task pending name='Task-17' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94>> got Future <Task pending name='Task-19' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:50:59,234 - ERROR - Job "run_insert_data (trigger: interval[0:00:10], next run at: 2024-11-30 16:51:09 CST)" raised an exception
Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 209, in execute_query
    await cursor.execute(query, values)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 239, in execute
    await self._query(query)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\cursors.py", line 457, in _query
    await conn.query(q)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 469, in query
    await self._read_query_result(unbuffered=unbuffered)
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 683, in _read_query_result
    await result.read()
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 1164, in read
    first_packet = await self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 609, in _read_packet
    packet_header = await self._read_bytes(4)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\connection.py", line 657, in _read_bytes
    data = await self._reader.readexactly(num_bytes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 728, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\streams.py", line 522, in _wait_for_data
    await self._waiter
RuntimeError: Task <Task pending name='Task-18' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Future pending> attached to a different loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\apscheduler\executors\base.py", line 131, in run_job
    retval = job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\main.py", line 32, in run_insert_data
    loop.run_until_complete(loop.create_task(insert_data()))  # 确保异步任务执行
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 94, in insert_data
    data = await load_data()
           ^^^^^^^^^^^^^^^^^
  File "D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py", line 22, in load_data
    users = await User.all()
            ^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\queryset.py", line 1059, in _execute
    instance_list = await self._db.executor_class(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\base\executor.py", line 131, in execute_select
    _, raw_results = await self.db.execute_query(query.get_sql())
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 54, in translate_exceptions_
    return await func(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\tortoise\backends\mysql\client.py", line 206, in execute_query
    async with self.acquire_connection() as connection:
RuntimeError: Task <Task pending name='Task-18' coro=<insert_data() running at D:\桌面\大三\计算机设计大赛\traval-back-end\src\utils\aprioriutils.py:94> cb=[_run_until_complete_cb() at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py:180]> got Future <Task pending name='Task-20' coro=<Pool._wakeup() running at C:\Users\罗渲渲\AppData\Local\Programs\Python\Python311\Lib\site-packages\aiomysql\pool.py:203>> attached to a different loop
2024-11-30 16:51:01,399 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:51:01,399 - INFO - Tortoise-ORM shutdown
2024-11-30 16:54:04,825 - DEBUG - Using selector: SelectSelector
2024-11-30 16:54:04,885 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:54:05,047 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001B28050F7D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:54:05,047 - INFO - Tortoise-ORM generating schema
2024-11-30 16:54:05,049 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:54:05,065 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:54:05,067 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001B2800E63D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:54:05,067 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:54:10,781 - DEBUG - SELECT `number`,`username`,`avatar`,`password`,`id` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:54:10,783 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`open_time` `open_time`,`site`.`location` `location`,`site`.`description` `description`,`site`.`city` `city`,`site`.`picture` `picture`,`site`.`transport` `transport`,`site`.`telephone` `telephone`,`site`.`type` `type`,`site`.`time_reference` `time_reference`,`site`.`name` `name`,`site`.`ticket` `ticket`,`site`.`longitude` `longitude`,`site`.`latitude` `latitude`,`site`.`id` `id` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:54:10,785 - DEBUG - SELECT `site`.`open_time`,`site`.`location`,`site`.`description`,`site`.`city`,`site`.`picture`,`site`.`transport`,`site`.`telephone`,`site`.`type`,`site`.`time_reference`,`site`.`name`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`id` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:54:10,786 - DEBUG - SELECT `site`.`open_time`,`site`.`location`,`site`.`description`,`site`.`city`,`site`.`picture`,`site`.`transport`,`site`.`telephone`,`site`.`type`,`site`.`time_reference`,`site`.`name`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`id` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:54:10,787 - DEBUG - SELECT `site_from_ids`,`relate_id`,`site_to_ids` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:54:32,349 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:54:32,350 - INFO - Tortoise-ORM shutdown
2024-11-30 16:54:33,315 - DEBUG - Using selector: SelectSelector
2024-11-30 16:54:33,375 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:54:33,539 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001EC0D949550>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:54:33,539 - INFO - Tortoise-ORM generating schema
2024-11-30 16:54:33,541 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:54:33,549 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:54:33,550 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001EC0D8D65D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:54:33,550 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:54:37,930 - DEBUG - Using selector: SelectSelector
2024-11-30 16:54:37,986 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:54:38,145 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000020A20EBFA10>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:54:38,145 - INFO - Tortoise-ORM generating schema
2024-11-30 16:54:38,147 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:54:38,158 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:54:38,158 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000020A3F26BD90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:54:38,159 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:54:41,095 - DEBUG - SELECT `number`,`avatar`,`id`,`username`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:54:41,096 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`description` `description`,`site`.`longitude` `longitude`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`type` `type`,`site`.`telephone` `telephone`,`site`.`name` `name`,`site`.`ticket` `ticket`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`time_reference` `time_reference`,`site`.`open_time` `open_time`,`site`.`location` `location`,`site`.`picture` `picture` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:54:41,099 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:54:41,101 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:54:41,102 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:54:52,090 - DEBUG - SELECT `description`,`longitude`,`transport`,`id`,`type`,`telephone`,`name`,`ticket`,`latitude`,`city`,`time_reference`,`open_time`,`location`,`picture` FROM `site` WHERE UPPER(CAST(`name` AS CHAR)) LIKE UPPER('%10%') LIMIT 7: None
2024-11-30 16:55:10,277 - DEBUG - SELECT `number`,`avatar`,`id`,`username`,`password` FROM `user`: None
2024-11-30 16:55:10,278 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:55:10,279 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:55:10,281 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:55:10,282 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:55:10,283 - INFO - [(1, 2, 3, 4, 7, 8), (3, 4, 8)]
2024-11-30 16:55:10,283 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,286 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*', '8*']
2024-11-30 16:55:10,291 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,291 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*', '4*']
2024-11-30 16:55:10,291 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,291 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*', 59]
2024-11-30 16:55:10,298 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,300 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['7*', '3*']
2024-11-30 16:55:10,300 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,302 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*', 61]
2024-11-30 16:55:10,302 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,302 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '4*', 59]
2024-11-30 16:55:10,306 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,306 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*', 60]
2024-11-30 16:55:10,306 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,309 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*', 60]
2024-11-30 16:55:10,309 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,309 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '4*', 61]
2024-11-30 16:55:10,309 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,309 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '3*4*', 59]
2024-11-30 16:55:10,314 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:55:10,316 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*', '4*']
2024-11-30 16:55:10,316 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:55:10,316 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*4*', '3*']
2024-11-30 16:55:10,316 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,316 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '3*4*', 61]
2024-11-30 16:55:10,316 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:55:10,316 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['3*7*', '4*']
2024-11-30 16:55:10,323 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:55:10,323 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['4*7*', '3*']
2024-11-30 16:55:10,323 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,323 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*7*', '3*']
2024-11-30 16:55:10,323 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,323 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*', 66]
2024-11-30 16:55:10,323 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,323 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*3*', 59]
2024-11-30 16:55:10,331 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:55:10,331 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*', '3*']
2024-11-30 16:55:10,331 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:55:10,331 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*', '8*', 62]
2024-11-30 16:55:10,331 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,331 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*3*', 61]
2024-11-30 16:55:10,331 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:55:10,331 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*7*', '3*']
2024-11-30 16:55:10,331 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:55:10,339 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['3*7*', '8*', 64]
2024-11-30 16:55:10,339 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,342 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*4*', 60]
2024-11-30 16:55:10,342 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:55:10,342 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*', '4*']
2024-11-30 16:55:10,342 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:55:10,342 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*4*', '8*']
2024-11-30 16:55:10,342 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,347 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*4*', 59]
2024-11-30 16:55:10,348 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:55:10,350 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*', '4*', 67]
2024-11-30 16:55:10,350 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:55:10,350 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*', '8*', 63]
2024-11-30 16:55:10,350 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,350 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '4*', 66]
2024-11-30 16:55:10,356 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,356 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*7*', '4*']
2024-11-30 16:55:10,356 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,356 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*', '4*']
2024-11-30 16:55:10,356 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,356 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*4*', 61]
2024-11-30 16:55:10,356 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:55:10,356 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*7*', '4*', 68]
2024-11-30 16:55:10,364 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:55:10,364 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['4*7*', '8*', 65]
2024-11-30 16:55:10,365 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,365 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '3*', 71]
2024-11-30 16:55:10,365 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,365 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*3*', 60]
2024-11-30 16:55:10,365 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:55:10,365 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*', '3*', 69]
2024-11-30 16:55:10,373 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:55:10,373 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*', '8*']
2024-11-30 16:55:10,373 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,373 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*', 71]
2024-11-30 16:55:10,376 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,376 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*', 72]
2024-11-30 16:55:10,376 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,376 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '3*', 72]
2024-11-30 16:55:10,381 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,381 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '3*4*', 60]
2024-11-30 16:55:10,381 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:55:10,381 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*', '4*', 73]
2024-11-30 16:55:10,381 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:55:10,381 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*', '3*', 70]
2024-11-30 16:55:10,385 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,385 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*4*', 66]
2024-11-30 16:55:10,385 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:55:10,389 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*7*', '4*']
2024-11-30 16:55:10,391 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,391 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*4*7*', '8*']
2024-11-30 16:55:10,391 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*' LIMIT 2: None
2024-11-30 16:55:10,391 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*', '8*3*4*', 60]
2024-11-30 16:55:10,391 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*' LIMIT 2: None
2024-11-30 16:55:10,391 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*', '3*4*', 69]
2024-11-30 16:55:10,391 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*' LIMIT 2: None
2024-11-30 16:55:10,391 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*', '8*4*', 73]
2024-11-30 16:55:10,399 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*' LIMIT 2: None
2024-11-30 16:55:10,399 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*', '8*3*', 70]
2024-11-30 16:55:10,399 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*3*' LIMIT 2: None
2024-11-30 16:55:10,399 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*3*', '4*']
2024-11-30 16:55:10,399 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*4*' LIMIT 2: None
2024-11-30 16:55:10,399 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*4*', '3*']
2024-11-30 16:55:10,406 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*4*' LIMIT 2: None
2024-11-30 16:55:10,406 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*4*', '8*']
2024-11-30 16:55:10,406 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,406 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*3*', 72]
2024-11-30 16:55:10,406 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:55:10,406 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*', '3*']
2024-11-30 16:55:10,406 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:55:10,406 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*', '8*']
2024-11-30 16:55:10,414 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,415 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*3*', 71]
2024-11-30 16:55:10,415 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:55:10,415 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*7*', '3*']
2024-11-30 16:55:10,415 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:55:10,415 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*7*', '8*']
2024-11-30 16:55:10,421 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,421 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*7*', '4*']
2024-11-30 16:55:10,423 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,423 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*3*', 66]
2024-11-30 16:55:10,423 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:55:10,423 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*7*', '3*', 74]
2024-11-30 16:55:10,423 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,423 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*7*', '8*']
2024-11-30 16:55:10,423 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,431 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*4*', 71]
2024-11-30 16:55:10,431 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:55:10,431 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*7*', '4*', 81]
2024-11-30 16:55:10,435 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:55:10,435 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*4*7*', '8*']
2024-11-30 16:55:10,435 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='7*' LIMIT 2: None
2024-11-30 16:55:10,435 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['7*', '8*3*4*', 61]
2024-11-30 16:55:10,435 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*7*' LIMIT 2: None
2024-11-30 16:55:10,435 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*7*', '3*4*', 68]
2024-11-30 16:55:10,442 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='3*7*' LIMIT 2: None
2024-11-30 16:55:10,442 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['3*7*', '8*4*', 64]
2024-11-30 16:55:10,442 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='4*7*' LIMIT 2: None
2024-11-30 16:55:10,442 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['4*7*', '8*3*', 65]
2024-11-30 16:55:10,442 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*3*7*' LIMIT 2: None
2024-11-30 16:55:10,442 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*3*7*', '4*']
2024-11-30 16:55:10,448 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*4*7*' LIMIT 2: None
2024-11-30 16:55:10,449 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*4*7*', '3*']
2024-11-30 16:55:10,449 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='3*4*7*' LIMIT 2: None
2024-11-30 16:55:10,449 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['3*4*7*', '8*']
2024-11-30 16:55:10,449 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,449 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*4*', 72]
2024-11-30 16:55:10,449 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:55:10,449 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*', '4*', 79]
2024-11-30 16:55:10,456 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:55:10,456 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*', '8*']
2024-11-30 16:55:10,456 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,456 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '3*', 83]
2024-11-30 16:55:10,456 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,456 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '3*4*', 72]
2024-11-30 16:55:10,456 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:55:10,464 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*', '4*', 80]
2024-11-30 16:55:10,466 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:55:10,466 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*', '3*', 89]
2024-11-30 16:55:10,466 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,466 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '3*4*', 71]
2024-11-30 16:55:10,466 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:55:10,466 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*7*', '4*', 82]
2024-11-30 16:55:10,466 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:55:10,466 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*7*', '3*', 85]
2024-11-30 16:55:10,473 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,473 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*', 83]
2024-11-30 16:55:10,475 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,475 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '3*4*', 66]
2024-11-30 16:55:10,475 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,475 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*7*', '4*', 84]
2024-11-30 16:55:10,475 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,475 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*7*', '3*', 75]
2024-11-30 16:55:10,481 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*' LIMIT 2: None
2024-11-30 16:55:10,481 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*', '8*3*4*', 59]
2024-11-30 16:55:10,481 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*' LIMIT 2: None
2024-11-30 16:55:10,481 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*', '3*4*', 67]
2024-11-30 16:55:10,481 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*' LIMIT 2: None
2024-11-30 16:55:10,481 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*', '8*4*', 62]
2024-11-30 16:55:10,481 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*' LIMIT 2: None
2024-11-30 16:55:10,481 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*', '8*3*', 63]
2024-11-30 16:55:10,490 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*3*' LIMIT 2: None
2024-11-30 16:55:10,490 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*3*', '4*']
2024-11-30 16:55:10,490 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*4*' LIMIT 2: None
2024-11-30 16:55:10,490 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*4*', '3*']
2024-11-30 16:55:10,490 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*4*' LIMIT 2: None
2024-11-30 16:55:10,490 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*4*', '8*']
2024-11-30 16:55:10,490 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*7*' LIMIT 2: None
2024-11-30 16:55:10,490 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*7*', '8*3*4*', 71]
2024-11-30 16:55:10,499 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*7*' LIMIT 2: None
2024-11-30 16:55:10,499 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*3*7*', '8*4*', 82]
2024-11-30 16:55:10,499 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*4*7*' LIMIT 2: None
2024-11-30 16:55:10,499 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*4*7*', '8*3*', 85]
2024-11-30 16:55:10,499 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*7*' LIMIT 2: None
2024-11-30 16:55:10,499 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*7*', '3*4*', 81]
2024-11-30 16:55:10,506 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*3*4*7*' LIMIT 2: None
2024-11-30 16:55:10,506 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*3*4*7*', '8*']
2024-11-30 16:55:10,506 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*3*7*' LIMIT 2: None
2024-11-30 16:55:10,506 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*3*7*', '4*']
2024-11-30 16:55:10,506 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*4*7*' LIMIT 2: None
2024-11-30 16:55:10,506 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*4*7*', '3*']
2024-11-30 16:55:10,506 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*' LIMIT 2: None
2024-11-30 16:55:10,513 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*', '8*3*4*', 72]
2024-11-30 16:55:10,515 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*' LIMIT 2: None
2024-11-30 16:55:10,516 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*', '8*4*', 80]
2024-11-30 16:55:10,516 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*' LIMIT 2: None
2024-11-30 16:55:10,516 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*', '8*3*', 89]
2024-11-30 16:55:10,516 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*' LIMIT 2: None
2024-11-30 16:55:10,516 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*', '3*4*', 79]
2024-11-30 16:55:10,516 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*4*' LIMIT 2: None
2024-11-30 16:55:10,516 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*4*', '8*']
2024-11-30 16:55:10,523 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*3*' LIMIT 2: None
2024-11-30 16:55:10,523 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*3*', '4*']
2024-11-30 16:55:10,526 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*4*' LIMIT 2: None
2024-11-30 16:55:10,526 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*4*', '3*']
2024-11-30 16:55:10,526 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,526 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '3*4*', 83]
2024-11-30 16:55:10,526 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,526 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*7*', '4*']
2024-11-30 16:55:10,532 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,532 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*7*', '3*']
2024-11-30 16:55:10,532 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,532 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*3*', 83]
2024-11-30 16:55:10,532 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,532 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*7*', '8*', 99]
2024-11-30 16:55:10,540 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,541 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*1*2*7*', '3*']
2024-11-30 16:55:10,541 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*7*' LIMIT 2: None
2024-11-30 16:55:10,541 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*7*', '8*3*4*', 66]
2024-11-30 16:55:10,541 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,541 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*3*7*', '8*4*', 84]
2024-11-30 16:55:10,541 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,541 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['2*4*7*', '8*3*', 75]
2024-11-30 16:55:10,549 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*7*' LIMIT 2: None
2024-11-30 16:55:10,549 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*2*7*', '3*4*', 74]
2024-11-30 16:55:10,551 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='2*3*4*7*' LIMIT 2: None
2024-11-30 16:55:10,551 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['2*3*4*7*', '8*']
2024-11-30 16:55:10,551 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,551 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*3*7*', '4*']
2024-11-30 16:55:10,551 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,551 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['8*2*4*7*', '3*']
2024-11-30 16:55:10,557 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,557 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*4*', 83]
2024-11-30 16:55:10,560 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,560 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*7*', '8*', 100]
2024-11-30 16:55:10,560 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,560 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*7*', '4*', 101]
2024-11-30 16:55:10,560 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,566 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*7*', '8*3*4*', 83]
2024-11-30 16:55:10,566 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*' LIMIT 2: None
2024-11-30 16:55:10,568 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*3*7*', '8*4*', 99]
2024-11-30 16:55:10,568 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*' LIMIT 2: None
2024-11-30 16:55:10,568 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['1*2*4*7*', '8*3*', 100]
2024-11-30 16:55:10,568 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='8*1*2*7*' LIMIT 2: None
2024-11-30 16:55:10,572 - DEBUG - UPDATE `siterelationship` SET `site_from_ids`=%s,`site_to_ids`=%s WHERE `relate_id`=%s: ['8*1*2*7*', '3*4*', 101]
2024-11-30 16:55:10,573 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*4*7*' LIMIT 2: None
2024-11-30 16:55:10,573 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*4*7*', '8*']
2024-11-30 16:55:10,573 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*3*7*8*' LIMIT 2: None
2024-11-30 16:55:10,573 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*3*7*8*', '4*']
2024-11-30 16:55:10,573 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids`='1*2*4*7*8*' LIMIT 2: None
2024-11-30 16:55:10,573 - DEBUG - INSERT INTO `siterelationship` (`site_from_ids`,`site_to_ids`) VALUES (%s,%s): ['1*2*4*7*8*', '3*']
2024-11-30 16:55:34,668 - DEBUG - SELECT `number`,`avatar`,`id`,`username`,`password` FROM `user` WHERE `number`='222' LIMIT 2: None
2024-11-30 16:55:34,670 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`description` `description`,`site`.`longitude` `longitude`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`type` `type`,`site`.`telephone` `telephone`,`site`.`name` `name`,`site`.`ticket` `ticket`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`time_reference` `time_reference`,`site`.`open_time` `open_time`,`site`.`location` `location`,`site`.`picture` `picture` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (2)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:55:34,673 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:55:34,674 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=2: None
2024-11-30 16:55:34,675 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('3','4','8'): None
2024-11-30 16:55:39,664 - DEBUG - SELECT `number`,`avatar`,`id`,`username`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:55:39,665 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`description` `description`,`site`.`longitude` `longitude`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`type` `type`,`site`.`telephone` `telephone`,`site`.`name` `name`,`site`.`ticket` `ticket`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`time_reference` `time_reference`,`site`.`open_time` `open_time`,`site`.`location` `location`,`site`.`picture` `picture` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:55:39,666 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:55:39,668 - DEBUG - SELECT `site`.`description`,`site`.`longitude`,`site`.`transport`,`site`.`id`,`site`.`type`,`site`.`telephone`,`site`.`name`,`site`.`ticket`,`site`.`latitude`,`site`.`city`,`site`.`time_reference`,`site`.`open_time`,`site`.`location`,`site`.`picture` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:55:39,668 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:58:34,088 - DEBUG - Using selector: SelectSelector
2024-11-30 16:58:34,146 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:58:34,310 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001B6E0AAED90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:58:34,310 - INFO - Tortoise-ORM generating schema
2024-11-30 16:58:34,313 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:58:34,325 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:58:34,326 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001B6DFFA3450> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:58:34,326 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:58:36,091 - DEBUG - SELECT `id`,`password`,`avatar`,`username`,`number` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:58:36,092 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`name` `name`,`site`.`description` `description`,`site`.`time_reference` `time_reference`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`telephone` `telephone`,`site`.`picture` `picture`,`site`.`type` `type`,`site`.`ticket` `ticket`,`site`.`longitude` `longitude`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`location` `location`,`site`.`open_time` `open_time` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:58:36,094 - DEBUG - SELECT `site`.`name`,`site`.`description`,`site`.`time_reference`,`site`.`transport`,`site`.`id`,`site`.`telephone`,`site`.`picture`,`site`.`type`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`city`,`site`.`location`,`site`.`open_time` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:58:36,095 - DEBUG - SELECT `site`.`name`,`site`.`description`,`site`.`time_reference`,`site`.`transport`,`site`.`id`,`site`.`telephone`,`site`.`picture`,`site`.`type`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`city`,`site`.`location`,`site`.`open_time` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:58:36,096 - DEBUG - SELECT `site_to_ids`,`relate_id`,`site_from_ids` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:58:37,585 - DEBUG - SELECT `id`,`password`,`avatar`,`username`,`number` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:58:37,586 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`name` `name`,`site`.`description` `description`,`site`.`time_reference` `time_reference`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`telephone` `telephone`,`site`.`picture` `picture`,`site`.`type` `type`,`site`.`ticket` `ticket`,`site`.`longitude` `longitude`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`location` `location`,`site`.`open_time` `open_time` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:58:37,588 - DEBUG - SELECT `site`.`name`,`site`.`description`,`site`.`time_reference`,`site`.`transport`,`site`.`id`,`site`.`telephone`,`site`.`picture`,`site`.`type`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`city`,`site`.`location`,`site`.`open_time` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:58:37,589 - DEBUG - SELECT `site`.`name`,`site`.`description`,`site`.`time_reference`,`site`.`transport`,`site`.`id`,`site`.`telephone`,`site`.`picture`,`site`.`type`,`site`.`ticket`,`site`.`longitude`,`site`.`latitude`,`site`.`city`,`site`.`location`,`site`.`open_time` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:58:37,593 - DEBUG - SELECT `site_to_ids`,`relate_id`,`site_from_ids` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:58:47,902 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:58:47,902 - INFO - Tortoise-ORM shutdown
2024-11-30 16:59:03,521 - DEBUG - Using selector: SelectSelector
2024-11-30 16:59:03,588 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:59:03,766 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000153F09AEE90>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:59:03,766 - INFO - Tortoise-ORM generating schema
2024-11-30 16:59:03,768 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:59:03,779 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:59:03,780 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000153F0CFE850> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:59:03,780 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 16:59:04,848 - DEBUG - SELECT `username`,`avatar`,`password`,`id`,`number` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 16:59:04,849 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`longitude` `longitude`,`site`.`transport` `transport`,`site`.`picture` `picture`,`site`.`id` `id`,`site`.`location` `location`,`site`.`open_time` `open_time`,`site`.`description` `description`,`site`.`city` `city`,`site`.`time_reference` `time_reference`,`site`.`ticket` `ticket`,`site`.`telephone` `telephone`,`site`.`latitude` `latitude`,`site`.`type` `type`,`site`.`name` `name` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 16:59:04,851 - DEBUG - SELECT `site`.`longitude`,`site`.`transport`,`site`.`picture`,`site`.`id`,`site`.`location`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`time_reference`,`site`.`ticket`,`site`.`telephone`,`site`.`latitude`,`site`.`type`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:59:04,852 - DEBUG - SELECT `site`.`longitude`,`site`.`transport`,`site`.`picture`,`site`.`id`,`site`.`location`,`site`.`open_time`,`site`.`description`,`site`.`city`,`site`.`time_reference`,`site`.`ticket`,`site`.`telephone`,`site`.`latitude`,`site`.`type`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 16:59:04,853 - DEBUG - SELECT `site_from_ids`,`site_to_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 16:59:53,741 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:59:53,741 - INFO - Tortoise-ORM shutdown
2024-11-30 16:59:57,003 - DEBUG - Using selector: SelectSelector
2024-11-30 16:59:57,060 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 16:59:57,228 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000022E6F9168D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 16:59:57,228 - INFO - Tortoise-ORM generating schema
2024-11-30 16:59:57,230 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:59:57,236 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 16:59:57,237 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000022E6F6365D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:59:57,237 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 16:59:57,915 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 16:59:57,915 - INFO - Tortoise-ORM shutdown
2024-11-30 17:00:03,769 - DEBUG - Using selector: SelectSelector
2024-11-30 17:00:03,827 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:00:03,984 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x00000200A7C3E7D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:00:03,984 - INFO - Tortoise-ORM generating schema
2024-11-30 17:00:03,986 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:00:03,999 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:00:04,000 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x00000200C5FDBF90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:00:04,000 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:00:07,559 - DEBUG - SELECT `number`,`password`,`id`,`avatar`,`username` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:00:07,561 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`picture` `picture`,`site`.`city` `city`,`site`.`location` `location`,`site`.`type` `type`,`site`.`name` `name`,`site`.`telephone` `telephone`,`site`.`latitude` `latitude`,`site`.`longitude` `longitude`,`site`.`id` `id`,`site`.`open_time` `open_time`,`site`.`time_reference` `time_reference`,`site`.`ticket` `ticket`,`site`.`transport` `transport`,`site`.`description` `description` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:00:07,565 - DEBUG - SELECT `site`.`picture`,`site`.`city`,`site`.`location`,`site`.`type`,`site`.`name`,`site`.`telephone`,`site`.`latitude`,`site`.`longitude`,`site`.`id`,`site`.`open_time`,`site`.`time_reference`,`site`.`ticket`,`site`.`transport`,`site`.`description` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:00:07,567 - DEBUG - SELECT `site`.`picture`,`site`.`city`,`site`.`location`,`site`.`type`,`site`.`name`,`site`.`telephone`,`site`.`latitude`,`site`.`longitude`,`site`.`id`,`site`.`open_time`,`site`.`time_reference`,`site`.`ticket`,`site`.`transport`,`site`.`description` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:00:07,568 - DEBUG - SELECT `site_to_ids`,`site_from_ids`,`relate_id` FROM `siterelationship` WHERE `site_from_ids` IN ('1','2','3','4','7','8'): None
2024-11-30 17:05:02,210 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:05:02,210 - INFO - Tortoise-ORM shutdown
2024-11-30 17:05:03,225 - DEBUG - Using selector: SelectSelector
2024-11-30 17:05:03,285 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:05:03,458 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000002725B19F3D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:05:03,458 - INFO - Tortoise-ORM generating schema
2024-11-30 17:05:03,460 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:05:03,469 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:05:03,470 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000002725AD763D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:05:03,470 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:05:04,361 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:05:04,361 - INFO - Tortoise-ORM shutdown
2024-11-30 17:08:09,449 - DEBUG - Using selector: SelectSelector
2024-11-30 17:08:09,506 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:08:09,679 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000002112695A910>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:08:09,679 - INFO - Tortoise-ORM generating schema
2024-11-30 17:08:09,681 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:08:09,687 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:08:09,688 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000021126C1E850> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:08:09,688 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:08:12,177 - DEBUG - SELECT `id`,`number`,`password`,`username`,`avatar` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:08:12,178 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`picture` `picture`,`site`.`id` `id`,`site`.`transport` `transport`,`site`.`ticket` `ticket`,`site`.`type` `type`,`site`.`latitude` `latitude`,`site`.`description` `description`,`site`.`city` `city`,`site`.`open_time` `open_time`,`site`.`telephone` `telephone`,`site`.`longitude` `longitude`,`site`.`location` `location`,`site`.`name` `name`,`site`.`time_reference` `time_reference` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:08:12,181 - DEBUG - SELECT `site`.`picture`,`site`.`id`,`site`.`transport`,`site`.`ticket`,`site`.`type`,`site`.`latitude`,`site`.`description`,`site`.`city`,`site`.`open_time`,`site`.`telephone`,`site`.`longitude`,`site`.`location`,`site`.`name`,`site`.`time_reference` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:08:12,182 - DEBUG - SELECT `site`.`picture`,`site`.`id`,`site`.`transport`,`site`.`ticket`,`site`.`type`,`site`.`latitude`,`site`.`description`,`site`.`city`,`site`.`open_time`,`site`.`telephone`,`site`.`longitude`,`site`.`location`,`site`.`name`,`site`.`time_reference` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:08:12,183 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:08:20,576 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:08:20,576 - INFO - Tortoise-ORM shutdown
2024-11-30 17:08:32,569 - DEBUG - Using selector: SelectSelector
2024-11-30 17:08:32,629 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:08:32,836 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000019D26BDF2D0>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:08:32,836 - INFO - Tortoise-ORM generating schema
2024-11-30 17:08:32,838 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:08:32,849 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:08:32,849 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000019D26A71890> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:08:32,849 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:08:33,726 - DEBUG - SELECT `username`,`number`,`avatar`,`id`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:08:33,729 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`longitude` `longitude`,`site`.`picture` `picture`,`site`.`description` `description`,`site`.`time_reference` `time_reference`,`site`.`ticket` `ticket`,`site`.`open_time` `open_time`,`site`.`city` `city`,`site`.`latitude` `latitude`,`site`.`type` `type`,`site`.`telephone` `telephone`,`site`.`transport` `transport`,`site`.`id` `id`,`site`.`location` `location`,`site`.`name` `name` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:08:33,731 - DEBUG - SELECT `site`.`longitude`,`site`.`picture`,`site`.`description`,`site`.`time_reference`,`site`.`ticket`,`site`.`open_time`,`site`.`city`,`site`.`latitude`,`site`.`type`,`site`.`telephone`,`site`.`transport`,`site`.`id`,`site`.`location`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:08:33,732 - DEBUG - SELECT `site`.`longitude`,`site`.`picture`,`site`.`description`,`site`.`time_reference`,`site`.`ticket`,`site`.`open_time`,`site`.`city`,`site`.`latitude`,`site`.`type`,`site`.`telephone`,`site`.`transport`,`site`.`id`,`site`.`location`,`site`.`name` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:08:33,734 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:09:02,473 - DEBUG - Using selector: SelectSelector
2024-11-30 17:09:02,532 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:09:02,723 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000023B4C3BF190>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:09:02,723 - INFO - Tortoise-ORM generating schema
2024-11-30 17:09:02,725 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 17:09:02,739 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:09:02,739 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000023B4C2463D0> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:09:02,739 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 17:09:03,499 - DEBUG - SELECT `avatar`,`id`,`number`,`username`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:09:03,501 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`description` `description`,`site`.`time_reference` `time_reference`,`site`.`type` `type`,`site`.`location` `location`,`site`.`id` `id`,`site`.`picture` `picture`,`site`.`telephone` `telephone`,`site`.`city` `city`,`site`.`open_time` `open_time`,`site`.`name` `name`,`site`.`latitude` `latitude`,`site`.`longitude` `longitude`,`site`.`ticket` `ticket`,`site`.`transport` `transport` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:09:03,502 - DEBUG - SELECT `site`.`description`,`site`.`time_reference`,`site`.`type`,`site`.`location`,`site`.`id`,`site`.`picture`,`site`.`telephone`,`site`.`city`,`site`.`open_time`,`site`.`name`,`site`.`latitude`,`site`.`longitude`,`site`.`ticket`,`site`.`transport` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:09:03,504 - DEBUG - SELECT `site`.`description`,`site`.`time_reference`,`site`.`type`,`site`.`location`,`site`.`id`,`site`.`picture`,`site`.`telephone`,`site`.`city`,`site`.`open_time`,`site`.`name`,`site`.`latitude`,`site`.`longitude`,`site`.`ticket`,`site`.`transport` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:09:03,505 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:09:29,322 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:09:29,322 - INFO - Tortoise-ORM shutdown
2024-11-30 17:09:32,692 - DEBUG - Using selector: SelectSelector
2024-11-30 17:09:32,750 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:09:32,907 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000002010B39EF50>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:09:32,907 - INFO - Tortoise-ORM generating schema
2024-11-30 17:09:32,909 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:09:32,916 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:09:32,917 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000002010B6EE850> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:09:32,917 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:09:41,875 - DEBUG - SELECT `username`,`id`,`avatar`,`password`,`number` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:09:41,877 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`open_time` `open_time`,`site`.`picture` `picture`,`site`.`transport` `transport`,`site`.`ticket` `ticket`,`site`.`location` `location`,`site`.`name` `name`,`site`.`description` `description`,`site`.`latitude` `latitude`,`site`.`id` `id`,`site`.`city` `city`,`site`.`time_reference` `time_reference`,`site`.`longitude` `longitude`,`site`.`type` `type`,`site`.`telephone` `telephone` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:09:41,880 - DEBUG - SELECT `site`.`open_time`,`site`.`picture`,`site`.`transport`,`site`.`ticket`,`site`.`location`,`site`.`name`,`site`.`description`,`site`.`latitude`,`site`.`id`,`site`.`city`,`site`.`time_reference`,`site`.`longitude`,`site`.`type`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:09:41,881 - DEBUG - SELECT `site`.`open_time`,`site`.`picture`,`site`.`transport`,`site`.`ticket`,`site`.`location`,`site`.`name`,`site`.`description`,`site`.`latitude`,`site`.`id`,`site`.`city`,`site`.`time_reference`,`site`.`longitude`,`site`.`type`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:09:41,882 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%3%'): None
2024-11-30 17:09:41,883 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%8%'): None
2024-11-30 17:09:41,884 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%1%'): None
2024-11-30 17:09:41,886 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:09:41,887 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%7%'): None
2024-11-30 17:09:41,887 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%2%'): None
2024-11-30 17:09:49,150 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:09:49,151 - INFO - Tortoise-ORM shutdown
2024-11-30 17:11:37,663 - DEBUG - Using selector: SelectSelector
2024-11-30 17:11:37,722 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:11:37,883 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000012673D8AF50>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:11:37,883 - INFO - Tortoise-ORM generating schema
2024-11-30 17:11:37,885 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:11:37,893 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:11:37,893 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001267E15CF10> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:11:37,894 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
2024-11-30 17:11:41,503 - DEBUG - SELECT `id`,`number`,`avatar`,`username`,`password` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:11:41,505 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`id` `id`,`site`.`type` `type`,`site`.`latitude` `latitude`,`site`.`longitude` `longitude`,`site`.`telephone` `telephone`,`site`.`open_time` `open_time`,`site`.`ticket` `ticket`,`site`.`location` `location`,`site`.`picture` `picture`,`site`.`name` `name`,`site`.`city` `city`,`site`.`transport` `transport`,`site`.`time_reference` `time_reference`,`site`.`description` `description` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:11:41,506 - DEBUG - SELECT `site`.`id`,`site`.`type`,`site`.`latitude`,`site`.`longitude`,`site`.`telephone`,`site`.`open_time`,`site`.`ticket`,`site`.`location`,`site`.`picture`,`site`.`name`,`site`.`city`,`site`.`transport`,`site`.`time_reference`,`site`.`description` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:11:41,507 - DEBUG - SELECT `site`.`id`,`site`.`type`,`site`.`latitude`,`site`.`longitude`,`site`.`telephone`,`site`.`open_time`,`site`.`ticket`,`site`.`location`,`site`.`picture`,`site`.`name`,`site`.`city`,`site`.`transport`,`site`.`time_reference`,`site`.`description` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:11:41,508 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%1%'): None
2024-11-30 17:11:41,509 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%3%'): None
2024-11-30 17:11:41,509 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:11:41,509 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%7%'): None
2024-11-30 17:11:41,511 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%2%'): None
2024-11-30 17:11:41,511 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%8%'): None
2024-11-30 17:11:56,753 - DEBUG - Using selector: SelectSelector
2024-11-30 17:11:56,813 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:11:56,981 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x000001916E38F310>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:11:56,981 - INFO - Tortoise-ORM generating schema
2024-11-30 17:11:56,983 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:11:56,992 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:11:56,993 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000001916DF94210> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:11:56,993 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:11:57,333 - DEBUG - SELECT `id`,`password`,`avatar`,`number`,`username` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:11:57,335 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`telephone` `telephone`,`site`.`open_time` `open_time`,`site`.`picture` `picture`,`site`.`longitude` `longitude`,`site`.`description` `description`,`site`.`location` `location`,`site`.`id` `id`,`site`.`latitude` `latitude`,`site`.`name` `name`,`site`.`transport` `transport`,`site`.`time_reference` `time_reference`,`site`.`type` `type`,`site`.`ticket` `ticket`,`site`.`city` `city` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:11:57,336 - DEBUG - SELECT `site`.`telephone`,`site`.`open_time`,`site`.`picture`,`site`.`longitude`,`site`.`description`,`site`.`location`,`site`.`id`,`site`.`latitude`,`site`.`name`,`site`.`transport`,`site`.`time_reference`,`site`.`type`,`site`.`ticket`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:11:57,337 - DEBUG - SELECT `site`.`telephone`,`site`.`open_time`,`site`.`picture`,`site`.`longitude`,`site`.`description`,`site`.`location`,`site`.`id`,`site`.`latitude`,`site`.`name`,`site`.`transport`,`site`.`time_reference`,`site`.`type`,`site`.`ticket`,`site`.`city` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:11:57,339 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%3%'): None
2024-11-30 17:11:57,340 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%7%'): None
2024-11-30 17:11:57,340 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%2%'): None
2024-11-30 17:11:57,341 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%8%'): None
2024-11-30 17:11:57,341 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%1%'): None
2024-11-30 17:11:57,342 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:12:31,598 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:12:31,598 - INFO - Tortoise-ORM shutdown
2024-11-30 17:12:34,655 - DEBUG - Using selector: SelectSelector
2024-11-30 17:12:34,716 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:12:34,888 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000024178BB2F50>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:12:34,888 - INFO - Tortoise-ORM generating schema
2024-11-30 17:12:34,891 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:12:34,902 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:12:34,903 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x000002417EED3F90> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:12:34,903 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
2024-11-30 17:12:35,830 - DEBUG - SELECT `username`,`password`,`avatar`,`number`,`id` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:12:35,832 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`name` `name`,`site`.`open_time` `open_time`,`site`.`latitude` `latitude`,`site`.`city` `city`,`site`.`transport` `transport`,`site`.`time_reference` `time_reference`,`site`.`ticket` `ticket`,`site`.`telephone` `telephone`,`site`.`longitude` `longitude`,`site`.`type` `type`,`site`.`picture` `picture`,`site`.`id` `id`,`site`.`description` `description`,`site`.`location` `location` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:12:35,834 - DEBUG - SELECT `site`.`name`,`site`.`open_time`,`site`.`latitude`,`site`.`city`,`site`.`transport`,`site`.`time_reference`,`site`.`ticket`,`site`.`telephone`,`site`.`longitude`,`site`.`type`,`site`.`picture`,`site`.`id`,`site`.`description`,`site`.`location` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:12:35,837 - DEBUG - SELECT `site`.`name`,`site`.`open_time`,`site`.`latitude`,`site`.`city`,`site`.`transport`,`site`.`time_reference`,`site`.`ticket`,`site`.`telephone`,`site`.`longitude`,`site`.`type`,`site`.`picture`,`site`.`id`,`site`.`description`,`site`.`location` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:12:35,839 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:12:35,840 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%2%'): None
2024-11-30 17:12:35,841 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%8%'): None
2024-11-30 17:12:35,842 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%7%'): None
2024-11-30 17:12:35,843 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%3%'): None
2024-11-30 17:12:35,843 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%1%'): None
2024-11-30 17:13:43,861 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:13:43,861 - INFO - Tortoise-ORM shutdown
2024-11-30 17:13:48,258 - DEBUG - Using selector: SelectSelector
2024-11-30 17:13:48,322 - DEBUG - Tortoise-ORM startup
    connections: {'default': 'mysql://root:2022***@localhost:3306/travel'}
    apps: {'models': {'models': ['src.model', 'aerich.models'], 'default_connection': 'default'}}
2024-11-30 17:13:48,488 - INFO - Tortoise-ORM started, {'default': <tortoise.backends.mysql.client.MySQLClient object at 0x0000017EB703F390>}, {'models': {'Conversation': <class 'src.model.Conversation'>, 'Restaurant': <class 'src.model.Restaurant'>, 'Review': <class 'src.model.Review'>, 'Site': <class 'src.model.Site'>, 'SiteRelationship': <class 'src.model.SiteRelationship'>, 'Strategy': <class 'src.model.Strategy'>, 'User': <class 'src.model.User'>, 'Video': <class 'src.model.Video'>, 'Aerich': <class 'aerich.models.Aerich'>}}
2024-11-30 17:13:48,488 - INFO - Tortoise-ORM generating schema
2024-11-30 17:13:48,491 - DEBUG - Creating schema: CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 17:13:48,500 - DEBUG - caching sha2: succeeded by fast path.
2024-11-30 17:13:48,501 - DEBUG - Created connection <aiomysql.pool.Pool object at 0x0000017ED5415510> pool with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:13:48,501 - DEBUG - CREATE TABLE IF NOT EXISTS `restaurant` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '餐厅名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `image` VARCHAR(255) NOT NULL  COMMENT '餐厅图片' DEFAULT 'static/restaurant/默认图片.png',
    `location` VARCHAR(500) NOT NULL  COMMENT '餐厅地址',
    `telephone` VARCHAR(100)   COMMENT '餐厅联系电话',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '餐厅'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `review` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `entity_type` VARCHAR(50) NOT NULL  COMMENT '类型',
    `user_id` BIGINT NOT NULL  COMMENT '用户ID',
    `content` LONGTEXT   COMMENT '评论内容',
    `created_at` DATETIME(6) NOT NULL  COMMENT '记录时间'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `site` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `name` VARCHAR(100) NOT NULL  COMMENT '景点名字',
    `city` VARCHAR(20) NOT NULL  COMMENT '城市',
    `description` VARCHAR(2000)   COMMENT '景点简介',
    `picture` VARCHAR(255) NOT NULL  COMMENT '景点图片' DEFAULT 'static/site/默认图片.png',
    `location` VARCHAR(255) NOT NULL  COMMENT '景点地址',
    `telephone` VARCHAR(255)   COMMENT '景点联系电话',
    `time_reference` VARCHAR(255)   COMMENT '景点用时参考',
    `transport` LONGTEXT   COMMENT '交通参考',
    `ticket` VARCHAR(3000)   COMMENT '景点门票',
    `open_time` VARCHAR(2000)   COMMENT '景点开放时间',
    `longitude` DECIMAL(9,6) NOT NULL  COMMENT '经度',
    `latitude` DECIMAL(9,6) NOT NULL  COMMENT '纬度',
    `type` VARCHAR(50) NOT NULL  COMMENT '对象类型' DEFAULT '景点'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `siterelationship` (
    `relate_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `site_from_ids` VARCHAR(2000) NOT NULL,
    `site_to_ids` VARCHAR(2000) NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `number` VARCHAR(11) NOT NULL  COMMENT '电话号码',
    `username` VARCHAR(20) NOT NULL  COMMENT '用户名' DEFAULT 'username',
    `password` VARCHAR(11) NOT NULL  COMMENT '密码',
    `avatar` VARCHAR(255) NOT NULL  COMMENT '头像' DEFAULT 'static/user/默认头像.png'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `conversation` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `content` VARCHAR(10000) NOT NULL  COMMENT '历史对话',
    `user_id` INT,
    CONSTRAINT `fk_conversa_user_84883661` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `strategy` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `strategy` VARCHAR(2048) NOT NULL  COMMENT '攻略，日期加地点',
    `user_id` INT,
    CONSTRAINT `fk_strategy_user_8cb2e272` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE SET NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `video` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `entity_id` INT NOT NULL  COMMENT '景点或餐厅ID',
    `video` VARCHAR(100) NOT NULL  COMMENT '视频地址' DEFAULT 'static/video/默认视频.mp4'
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `aerich` (
    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `version` VARCHAR(255) NOT NULL,
    `app` VARCHAR(100) NOT NULL,
    `content` JSON NOT NULL
) CHARACTER SET utf8mb4;
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `restaurant_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_restaur_df0b6d` (`restaurant_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该餐厅的用户';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__site_id_4cdce2` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='访问过该景点的用户';
CREATE TABLE IF NOT EXISTS `user_site` (
    `site_id` INT NOT NULL,
    `user_id` INT NOT NULL,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_site_id_4e82d5` (`site_id`, `user_id`)
) CHARACTER SET utf8mb4 COMMENT='喜欢该景点的用户';
CREATE TABLE IF NOT EXISTS `user_restaurant` (
    `user_id` INT NOT NULL,
    `restaurant_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`restaurant_id`) REFERENCES `restaurant` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_restau_user_id_cf2a7f` (`user_id`, `restaurant_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的餐厅';
CREATE TABLE IF NOT EXISTS `user_visit_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_visit__user_id_981e3c` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户访问过的的景点';
CREATE TABLE IF NOT EXISTS `user_site` (
    `user_id` INT NOT NULL,
    `site_id` INT NOT NULL,
    FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE,
    FOREIGN KEY (`site_id`) REFERENCES `site` (`id`) ON DELETE CASCADE,
    UNIQUE KEY `uidx_user_site_user_id_45bc6d` (`user_id`, `site_id`)
) CHARACTER SET utf8mb4 COMMENT='用户收藏的景点';
2024-11-30 17:13:50,456 - DEBUG - SELECT `number`,`password`,`id`,`avatar`,`username` FROM `user` WHERE `number`='121' LIMIT 2: None
2024-11-30 17:13:50,458 - DEBUG - SELECT `sq0`.`_backward_relation_key` `_backward_relation_key`,`site`.`transport` `transport`,`site`.`time_reference` `time_reference`,`site`.`city` `city`,`site`.`ticket` `ticket`,`site`.`name` `name`,`site`.`description` `description`,`site`.`open_time` `open_time`,`site`.`longitude` `longitude`,`site`.`latitude` `latitude`,`site`.`type` `type`,`site`.`id` `id`,`site`.`location` `location`,`site`.`picture` `picture`,`site`.`telephone` `telephone` FROM `site` JOIN (SELECT `user_id` `_backward_relation_key`,`site_id` `_forward_relation_key` FROM `user_site` WHERE `user_id` IN (1)) `sq0` ON `sq0`.`_forward_relation_key`=`site`.`id`: None
2024-11-30 17:13:50,459 - DEBUG - SELECT `site`.`transport`,`site`.`time_reference`,`site`.`city`,`site`.`ticket`,`site`.`name`,`site`.`description`,`site`.`open_time`,`site`.`longitude`,`site`.`latitude`,`site`.`type`,`site`.`id`,`site`.`location`,`site`.`picture`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:13:50,460 - DEBUG - SELECT `site`.`transport`,`site`.`time_reference`,`site`.`city`,`site`.`ticket`,`site`.`name`,`site`.`description`,`site`.`open_time`,`site`.`longitude`,`site`.`latitude`,`site`.`type`,`site`.`id`,`site`.`location`,`site`.`picture`,`site`.`telephone` FROM `site` LEFT OUTER JOIN `user_site` ON `site`.`id`=`user_site`.`site_id` WHERE `user_site`.`user_id`=1: None
2024-11-30 17:13:50,462 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%1%'): None
2024-11-30 17:13:50,462 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%4%'): None
2024-11-30 17:13:50,464 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%3%'): None
2024-11-30 17:13:50,464 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%7%'): None
2024-11-30 17:13:50,465 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%2%'): None
2024-11-30 17:13:50,466 - DEBUG - SELECT `site_to_ids` `site_to_ids` FROM `siterelationship` WHERE UPPER(CAST(`site_from_ids` AS CHAR)) LIKE UPPER('%8%'): None
2024-11-30 17:13:59,259 - DEBUG - Closed connection None with params: {'host': 'localhost', 'port': 3306, 'user': 'root', 'db': 'travel', 'autocommit': True, 'charset': 'utf8mb4', 'minsize': 1, 'maxsize': 5, 'sql_mode': 'STRICT_TRANS_TABLES'}
2024-11-30 17:13:59,259 - INFO - Tortoise-ORM shutdown
